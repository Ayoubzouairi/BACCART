<!DOCTYPE html>
<html lang="ar">
<head>
  <!-- بقية الهيد كما هي بدون تغيير -->
</head>
<body>
  <!-- بقية الهيكل HTML كما هو بدون تغيير -->

  <script>
    // بقية المتغيرات كما هي
    
    function generateAdvice() {
      const lang = document.getElementById('langSelect').value;
      const isArabic = lang === 'ar-MA';
      
      if (history.length < 3) {
        document.getElementById('aiAdvice').innerHTML = isArabic ? 
          "⏳ انتظر المزيد من الجولات لتحليل الأنماط..." : 
          "⏳ Wait for more rounds to analyze patterns...";
        return;
      }

      // تحليل آخر 10 جولات
      const lastTen = history.slice(-10);
      const counts = { P: 0, B: 0, T: 0 };
      lastTen.forEach(r => counts[r]++);
      
      // تحديد النتيجة الأكثر تكرارًا
      const mostFrequent = Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b);
      const freqPercent = (counts[mostFrequent] / lastTen.length * 100).toFixed(1);
      
      // تحليل السلسلة الحالية
      let streakText = "";
      if (currentStreak.count > 2) {
        const typeName = isArabic ? 
          (currentStreak.type === 'P' ? 'اللاعب' : currentStreak.type === 'B' ? 'المصرفي' : 'تعادل') :
          (currentStreak.type === 'P' ? 'Player' : currentStreak.type === 'B' ? 'Banker' : 'Tie');
        
        streakText = isArabic ?
          `📈 سلسلة ${typeName} مستمرة: ${currentStreak.count} جولات` :
          `📈 ${typeName} streak: ${currentStreak.count} rounds`;
      }

      // تحليل النتائج الساخنة/الباردة (جميع الجولات من البداية)
      let hotColdText = "";
      if (history.length >= 6) { // يبدأ التحليل فقط عند 6 جولات أو أكثر
        const hotCold = { P: 0, B: 0, T: 0 };
        history.forEach(r => hotCold[r]++);
        
        hotColdText = isArabic ? "🔥 النتائج الساخنة (جميع الجولات): " : "🔥 Hot (all rounds): ";
        Object.keys(hotCold).forEach(key => {
          const typeName = isArabic ? 
            (key === 'P' ? 'لاعب' : key === 'B' ? 'مصرفي' : 'تعادل') :
            (key === 'P' ? 'Player' : key === 'B' ? 'Banker' : 'Tie');
          
          // تحديد إذا كانت النتيجة ساخنة (أكثر من 40% من المجموع)
          const percentage = (hotCold[key] / history.length * 100);
          hotColdText += `<span class="${percentage > 40 ? 'hot' : 'cold'}">${typeName} ${hotCold[key]} (${percentage.toFixed(1)}%)</span> `;
        });
      }

      // تقديم توصية مبسطة
      let recommendation = "";
      if (currentStreak.count >= 3) {
        recommendation = isArabic ?
          `💡 استمر في الرهان على ${currentStreak.type === 'P' ? 'اللاعب' : currentStreak.type === 'B' ? 'المصرفي' : 'تعادل'}` :
          `💡 Keep betting on ${currentStreak.type === 'P' ? 'Player' : currentStreak.type === 'B' ? 'Banker' : 'Tie'}`;
      } else if (parseFloat(freqPercent) > 50) {
        const typeName = isArabic ?
          (mostFrequent === 'P' ? 'اللاعب' : mostFrequent === 'B' ? 'المصرفي' : 'تعادل') :
          (mostFrequent === 'P' ? 'Player' : mostFrequent === 'B' ? 'Banker' : 'Tie');
        
        recommendation = isArabic ?
          `💡 رهان آمن على ${typeName} (${freqPercent}%)` :
          `💡 Safe bet on ${typeName} (${freqPercent}%)`;
      } else {
        recommendation = isArabic ?
          "💡 لا يوجد نمط واضح، استخدم استراتيجية متحفظة" :
          "💡 No clear pattern, use conservative strategy";
      }

      // عرض كل التحليلات
      document.getElementById('aiAdvice').innerHTML = `
        ${streakText ? `<div>${streakText}</div>` : ''}
        ${hotColdText ? `<div>${hotColdText}</div>` : ''}
        <div class="probability">${recommendation}</div>
      `;
    }

    // بقية الدوال كما هي بدون تغيير
  </script>
</body>
</html>
