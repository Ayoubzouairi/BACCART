<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>BACCARAT PREDICTOR PRO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background-color: #121212;
      color: gold;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      padding: 2em;
      direction: rtl;
      text-align: center;
      transition: all 0.3s ease;
    }
    
    body.light-mode {
      background-color: #f5f5f5;
      color: #333;
    }
    
    h1 { 
      font-size: 2.5em; 
      margin-bottom: 20px; 
    }
    
    .bet-amount-container {
      margin: 20px auto;
      padding: 15px;
      background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,215,0,0.05));
      border-radius: 15px;
      max-width: 300px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      border: 1px solid rgba(255,215,0,0.3);
    }
    
    .language-container {
      position: absolute;
      top: 20px;
      left: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .bar {
      height: 24px;
      margin: 8px 0;
      border-radius: 5px;
      text-align: right;
      padding-right: 10px;
      font-weight: bold;
      line-height: 24px;
      color: #fff;
    }
    
    .bar.player { background-color: #007BFF; }
    .bar.banker { background-color: #DC3545; }
    .bar.tie { background-color: #28A745; }
    
    .buttons button {
      padding: 1em 1.8em;
      font-size: 1.1em;
      margin: 0.5em;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      min-width: 120px;
    }
    
    .player { 
      background-color: #007bff; 
      color: white; 
      border-bottom: 4px solid #0056b3;
    }
    
    .banker { 
      background-color: #dc3545; 
      color: white;
      border-bottom: 4px solid #a71d2a;
    }
    
    .tie { 
      background-color: #28a745; 
      color: white;
      border-bottom: 4px solid #1e7e34;
    }
    
    .reset { 
      background-color: #555; 
      color: gold; 
      margin-top: 1.5em;
      padding: 0.8em 2em;
      border-bottom: 4px solid #333;
    }
    
    .results-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1em 0;
      text-align: center;
    }
    
    .player-text { color: #007bff; }
    .banker-text { color: #dc3545; }
    .tie-text { color: #28a745; }
    
    .balance-display {
      font-size: 1.3em;
      font-weight: bold;
      padding: 12px;
      border-radius: 10px;
      background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,215,0,0.05));
      display: inline-block;
      min-width: 200px;
      margin: 10px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    @media (max-width: 768px) {
      body {
        padding: 1em;
      }
      .buttons button {
        padding: 0.8em;
        min-width: 100px;
        font-size: 1em;
      }
    }
  </style>
</head>
<body>
  <div class="language-container">
    <select id="langSelect" class="language">
      <option value="ar-MA">ğŸ‡²ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
      <option value="en-US">ğŸ‡ºğŸ‡¸ English</option>
    </select>
    <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
  </div>

  <h1>BACCARAT PREDICTOR PRO</h1>
  
  <div class="bet-amount-container">
    <label for="betAmount" Ù…Ø¨Ù„Øº Ø§Ù„Ø±Ù‡Ø§Ù† Ø¨Ø¯Ø±Ù‡Ù… </label>
    <input type="number" id="betAmount" class="amount" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" min="1" step="1">
  </div>
  
  <p>ğŸ“² Ø§Ø®ØªØ± Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¬ÙˆÙ„Ø©:</p>
  <div class="buttons">
    <button class="player" onclick="addResult('P')">
      ğŸ”µ Ø§Ù„Ù„Ø§Ø¹Ø¨
      <div class="bet-odds">1:1</div>
    </button>
    <button class="banker" onclick="addResult('B')">
      ğŸ”´ Ø§Ù„Ù…ØµØ±ÙÙŠ
      <div class="bet-odds">0.95:1</div>
    </button>
    <button class="tie" onclick="addResult('T')">
      ğŸŸ¢ ØªØ¹Ø§Ø¯Ù„
      <div class="bet-odds">8:1</div>
    </button>
  </div>

  <div class="stats" id="statsResult"></div>
  <div class="history" id="historyDisplay"></div>
  <div class="balance-display" id="balanceDisplay">
    ğŸ’µ Ø§Ù„Ø±ØµÙŠØ¯: <span id="balanceValue">0</span> Ø¯Ø±Ù‡Ù…
  </div>
  
  <div style="margin-top: 20px;">
    <button class="reset" onclick="resetData()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
  </div>

  <canvas id="chart" width="400" height="150"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
    let history = [];
    let balance = ; // Ø±ØµÙŠØ¯ Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ø¯Ø±Ù‡Ù…
    let balanceHistory = [];
    let currentStreak = { type: null, count: 0 };
    let betsHistory = [];
    let lang = 'ar-MA';
    let chart;

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    document.addEventListener('DOMContentLoaded', function() {
      loadTheme();
      loadLanguage();
      initChart();
      document.getElementById('langSelect').addEventListener('change', changeLanguage);
      document.getElementById('balanceValue').textContent = balance.toFixed(2);
    });

    // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    function initChart() {
      const ctx = document.getElementById('chart').getContext('2d');
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: balanceHistory.map((_, i) => i),
          datasets: [{
            label: 'Ø§Ù„Ø±ØµÙŠØ¯',
            data: balanceHistory,
            backgroundColor: 'rgba(255, 215, 0, 0.2)',
            borderColor: 'gold',
            borderWidth: 2,
            pointBackgroundColor: 'gold',
            pointRadius: 4,
            fill: true,
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false }
          }
        }
      });
    }

    function toggleTheme() {
      document.body.classList.toggle('light-mode');
      localStorage.setItem('theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
    }

    function loadTheme() {
      if (localStorage.getItem('theme') === 'light') {
        document.body.classList.add('light-mode');
      }
    }

    function changeLanguage() {
      lang = document.getElementById('langSelect').value;
      localStorage.setItem('lang', lang);
      updateUI();
    }

    function loadLanguage() {
      const savedLang = localStorage.getItem('lang') || 'ar-MA';
      document.getElementById('langSelect').value = savedLang;
      lang = savedLang;
    }

    function addResult(result) {
      const betAmount = parseFloat(document.getElementById('betAmount').value) || 0;
      document.getElementById('betAmount').value = '';
      
      if (betAmount > balance && betAmount > 0) {
        alert(lang === 'ar-MA' ? 'Ø§Ù„Ø±ØµÙŠØ¯ ØºÙŠØ± ÙƒØ§ÙÙŠ!' : 'Insufficient balance!');
        return;
      }
      
      history.push(result);
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      if (result === currentStreak.type) {
        currentStreak.count++;
      } else {
        currentStreak.type = result;
        currentStreak.count = 1;
      }
      
      const round = history.length;
      const betOn = event.target.classList.contains('player') ? 'P' : 
                   event.target.classList.contains('banker') ? 'B' : 'T';
      
      const profit = calculateProfit(betOn, result, betAmount);
      
      betsHistory.push({
        round,
        betOn,
        amount: betAmount,
        outcome: result,
        profit,
        timestamp: new Date()
      });
      
      updateBalance(profit);
      updateDisplay();
      updatePredictions();
    }

    // Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ù…ØµØ­Ø­Ø© Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø±Ø¨Ø­
    function calculateProfit(betOn, outcome, amount) {
      if (!amount || amount <= 0) return 0;
      
      if (betOn === outcome) {
        if (betOn === 'T') return amount * 0;  // Ø±Ø¨Ø­ 0 Ø£Ø¶Ø¹Ø§Ù Ø§Ù„Ù…Ø¨Ù„Øº Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø§Ø¯Ù„
        if (betOn === 'B') return amount * 0.95; // Ø±Ø¨Ø­ 95% Ù…Ù† Ø§Ù„Ù…Ø¨Ù„Øº Ø¹Ù†Ø¯ Ø§Ù„Ù…ØµØ±ÙÙŠ
        return amount * 1; // Ø±Ø¨Ø­ Ù…Ø³Ø§ÙˆÙŠ Ù„Ù„Ù…Ø¨Ù„Øº Ø¹Ù†Ø¯ Ø§Ù„Ù„Ø§Ø¹Ø¨
      }
      return -amount; // Ø®Ø³Ø§Ø±Ø© ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ù…Ø±Ø§Ù‡Ù†
    }

    function updateBalance(profit) {
      balance += profit;
      balanceHistory.push(balance);
      document.getElementById('balanceValue').textContent = balance.toFixed(2);
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
      chart.data.labels = balanceHistory.map((_, i) => i);
      chart.data.datasets[0].data = balanceHistory;
      chart.update();
      
      // ØªØ£Ø«ÙŠØ± Ø¨Ø³ÙŠØ· Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯
      const balanceDisplay = document.getElementById('balanceDisplay');
      balanceDisplay.style.transform = 'scale(1.05)';
      setTimeout(() => {
        balanceDisplay.style.transform = 'scale(1)';
      }, 300);
    }

    function updateDisplay() {
      const displayText = history.map(r => {
        if (r === 'P') return 'ğŸ”µ';
        if (r === 'B') return 'ğŸ”´';
        if (r === 'T') return 'ğŸŸ¢';
      }).join(' ');
      document.getElementById('historyDisplay').innerText = (lang === 'ar-MA' ? "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª: " : "All rounds: ") + displayText;

      const totalRounds = history.length;
      const count = { P: 0, B: 0, T: 0 };
      history.forEach(r => { if (count[r] !== undefined) count[r]++; });

      const statsHTML = `
        <table class="results-table">
          <tr>
            <th>${lang === 'ar-MA' ? 'Ø¹Ø¯Ø¯ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª' : 'Rounds'}</th>
            <th class="player-text">${lang === 'ar-MA' ? 'Ù„Ø§Ø¹Ø¨' : 'Player'}</th>
            <th class="banker-text">${lang === 'ar-MA' ? 'Ù…ØµØ±ÙÙŠ' : 'Banker'}</th>
            <th class="tie-text">${lang === 'ar-MA' ? 'ØªØ¹Ø§Ø¯Ù„' : 'Tie'}</th>
          </tr>
          <tr>
            <td>${totalRounds}</td>
            <td class="player-text">${count.P} (${((count.P/totalRounds)*100).toFixed(1)}%)</td>
            <td class="banker-text">${count.B} (${((count.B/totalRounds)*100).toFixed(1)}%)</td>
            <td class="tie-text">${count.T} (${((count.T/totalRounds)*100).toFixed(1)}%)</td>
          </tr>
        </table>
      `;
      document.getElementById('statsResult').innerHTML = statsHTML;
    }

    function updatePredictions() {
      const prediction = advancedPredict(history);
      displayPrediction(prediction);
    }

    function advancedPredict(history) {
      if (history.length < 3) {
        return { P: 33.3, B: 33.3, T: 33.3 };
      }

      const lastFive = history.slice(-5);
      const lastTen = history.length >= 10 ? history.slice(-10) : lastFive;
      
      const freq5 = { P: 0, B: 0, T: 0 };
      const freq10 = { P: 0, B: 0, T: 0 };
      
      lastFive.forEach(r => freq5[r]++);
      lastTen.forEach(r => freq10[r]++);
      
      const percent5 = {
        P: (freq5.P / 5) * 100,
        B: (freq5.B / 5) * 100,
        T: (freq5.T / 5) * 100
      };
      
      const percent10 = {
        P: (freq10.P / lastTen.length) * 100,
        B: (freq10.B / lastTen.length) * 100,
        T: (freq10.T / lastTen.length) * 100
      };
      
      const weightedAvg = {
        P: (percent5.P * 0.6 + percent10.P * 0.4),
        B: (percent5.B * 0.6 + percent10.B * 0.4),
        T: (percent5.T * 0.6 + percent10.T * 0.4)
      };
      
      const total = weightedAvg.P + weightedAvg.B + weightedAvg.T;
      return {
        P: (weightedAvg.P / total * 100),
        B: (weightedAvg.B / total * 100),
        T: (weightedAvg.T / total * 100)
      };
    }

    function displayPrediction(prediction) {
      const isArabic = lang === 'ar-MA';
      const statsHTML = `
        <span class="player-text">ğŸ”µ ${isArabic ? 'Ù„Ø§Ø¹Ø¨' : 'Player'}: ${prediction.P.toFixed(1)}%</span> | 
        <span class="banker-text">ğŸ”´ ${isArabic ? 'Ù…ØµØ±ÙÙŠ' : 'Banker'}: ${prediction.B.toFixed(1)}%</span> | 
        <span class="tie-text">ğŸŸ¢ ${isArabic ? 'ØªØ¹Ø§Ø¯Ù„' : 'Tie'}: ${prediction.T.toFixed(1)}%</span>
      `;
      document.getElementById('statsResult').innerHTML += `<div style="margin-top:10px;">${statsHTML}</div>`;
    }

    function resetData() {
      const isArabic = lang === 'ar-MA';
      if (confirm(isArabic ? 
          "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ" : 
          "Are you sure you want to reset all data?")) {
        history = [];
        balance = 1000;
        balanceHistory = [1000];
        betsHistory = [];
        currentStreak = { type: null, count: 0 };
        initChart();
        document.getElementById('statsResult').innerText = '';
        document.getElementById('historyDisplay').innerText = '';
        document.getElementById('balanceValue').textContent = '1000.00';
        document.getElementById('betAmount').value = '';
      }
    }

    function updateUI() {
      const isArabic = lang === 'ar-MA';
      document.querySelector('h1').textContent = 'BACCARAT PREDICTOR PRO';
      document.querySelector('.bet-amount-container label').textContent = isArabic ? 'ğŸ’° Ù…Ø¨Ù„Øº Ø§Ù„Ø±Ù‡Ø§Ù† Ø¨Ø§Ù„Ø¯Ø±Ù‡Ù…' : 'ğŸ’° Bet Amount (MAD)';
      document.querySelector('#betAmount').placeholder = isArabic ? 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' : 'Enter amount (optional)';
      document.querySelector('p').textContent = isArabic ? 'ğŸ“² Ø§Ø®ØªØ± Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¬ÙˆÙ„Ø©:' : 'ğŸ“² Select round result:';
      document.querySelector('.player').innerHTML = isArabic ? 'ğŸ”µ Ø§Ù„Ù„Ø§Ø¹Ø¨ <div class="bet-odds">1:1</div>' : 'ğŸ”µ Player <div class="bet-odds">1:1</div>';
      document.querySelector('.banker').innerHTML = isArabic ? 'ğŸ”´ Ø§Ù„Ù…ØµØ±ÙÙŠ <div class="bet-odds">0.95:1</div>' : 'ğŸ”´ Banker <div class="bet-odds">0.95:1</div>';
      document.querySelector('.tie').innerHTML = isArabic ? 'ğŸŸ¢ ØªØ¹Ø§Ø¯Ù„ <div class="bet-odds">8:1</div>' : 'ğŸŸ¢ Tie <div class="bet-odds">8:1</div>';
      document.querySelector('#balanceDisplay').innerHTML = isArabic ? 'ğŸ’µ Ø§Ù„Ø±ØµÙŠØ¯: <span id="balanceValue">1000.00</span> Ø¯Ø±Ù‡Ù…' : 'ğŸ’µ Balance: <span id="balanceValue">1000.00</span> MAD';
      document.querySelector('.reset').textContent = isArabic ? 'ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†' : 'ğŸ”„ Reset';
    }
  </script>
</body>
</html>
