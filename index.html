<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>BACCARAT</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      background-color: #121212;
      color: gold;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      padding: 2em;
      direction: rtl;
      text-align: center;
    }
    h1 {
      font-size: 2.5em;
    }
    .buttons button {
      padding: 0.7em 1.5em;
      font-size: 1em;
      margin: 0.5em;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    .player { background-color: #007bff; color: white; }
    .banker { background-color: #dc3545; color: white; }
    .tie { background-color: #28a745; color: white; }
    .language, .amount {
      margin-top: 1em;
      padding: 0.5em;
      font-size: 1em;
      width: 220px;
    }
    .result, .stats, .history, .balance {
      margin-top: 1.5em;
      font-size: 1.2em;
    }
    canvas {
      margin-top: 2em;
      max-width: 100%;
    }
  </style>
</head>
<body>
  <h1>BACCARAT</h1>
  <p>ğŸ“² Ø§Ø®ØªØ± Ù†ØªÙŠØ¬Ø© ÙƒÙ„ Ø¬ÙˆÙ„Ø©:</p>
  <div class="buttons">
    <button class="player" onclick="addResult('P')">ğŸ”µ Ø§Ù„Ù„Ø§Ø¹Ø¨</button>
    <button class="banker" onclick="addResult('B')">ğŸ”´ Ø§Ù„Ù…ØµØ±ÙÙŠ</button>
    <button class="tie" onclick="addResult('T')">ğŸŸ¢ ØªØ¹Ø§Ø¯Ù„</button>
  </div>

  <input type="number" id="betAmount" class="amount" placeholder="ğŸ’° Ù…Ø¨Ù„Øº Ø§Ù„Ø±Ù‡Ø§Ù† Ø¨Ø§Ù„Ø¯Ø±Ù‡Ù…" />
  <br />
  <select id="langSelect" class="language">
    <option value="ar-MA">ğŸ‡²ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
    <option value="en-US">ğŸ‡ºğŸ‡¸ English</option>
  </select>

  <div class="result" id="predictionResult"></div>
  <div class="stats" id="statsResult"></div>
  <div class="history" id="historyDisplay"></div>
  <div class="balance" id="balanceDisplay">ğŸ’µ Ø§Ù„Ø±ØµÙŠØ¯: 0 Ø¯Ø±Ù‡Ù…</div>

  <canvas id="chart" width="400" height="150"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let history = [];
    let balance = 0;
    let balanceHistory = [];

    const ctx = document.getElementById('chart').getContext('2d');
    const chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: 'Ø§Ù„Ø±ØµÙŠØ¯',
          data: [],
          backgroundColor: 'gold',
          borderColor: 'gold',
          fill: false,
        }]
      },
      options: {
        scales: {
          y: { beginAtZero: true }
        }
      }
    });

    function speak(text, lang) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = lang;
      speechSynthesis.speak(utter);
    }

    function updateChart() {
      chart.data.labels = balanceHistory.map((_, i) => i + 1);
      chart.data.datasets[0].data = balanceHistory;
      chart.update();
    }

    function addResult(result) {
      history.push(result);
      updateDisplay();
      predict(result);
    }

    function updateDisplay() {
      const displayText = history.map(r => {
        if (r === 'P') return 'ğŸ”µ';
        if (r === 'B') return 'ğŸ”´';
        if (r === 'T') return 'ğŸŸ¢';
      }).join(' ');
      document.getElementById('historyDisplay').innerText = "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª: " + displayText;
    }

    function predict(actualResult) {
      const lang = document.getElementById('langSelect').value;
      const lastFive = history.slice(-5);
      const count = { P: 0, B: 0, T: 0 };
      lastFive.forEach(r => { if (count[r] !== undefined) count[r]++; });

      const total = lastFive.length;
      const percent = {
        P: ((count.P / total) * 100).toFixed(1),
        B: ((count.B / total) * 100).toFixed(1),
        T: ((count.T / total) * 100).toFixed(1)
      };

      let winner = 'P';
      if (count.B >= count.P && count.B >= count.T) winner = 'B';
      else if (count.T > count.P && count.T > count.B) winner = 'T';

      const labels = {
        ar: { P: 'Ø§Ù„Ù„Ø§Ø¹Ø¨', B: 'Ø§Ù„Ù…ØµØ±ÙÙŠ', T: 'ØªØ¹Ø§Ø¯Ù„' },
        en: { P: 'Player', B: 'Banker', T: 'Tie' }
      };

      const label = lang === 'ar-MA' ? labels.ar[winner] : labels.en[winner];
      const speechText = lang === 'ar-MA'
        ? `ØªÙˆÙ‚Ø¹ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©: ${label} Ø¨Ù†Ø³Ø¨Ø© ${percent[winner]} Ø¨Ø§Ù„Ù…Ø¦Ø©`
        : `Next round prediction: ${label} with ${percent[winner]} percent`;

      document.getElementById('predictionResult').innerText = speechText;
      document.getElementById('statsResult').innerText =
        `Player: ${percent.P}% | Banker: ${percent.B}% | Tie: ${percent.T}%`;

      speak(speechText, lang);

      const bet = parseFloat(document.getElementById('betAmount').value) || 0;
      if (actualResult && winner && bet > 0) {
        if (actualResult === winner) {
          balance += bet;
        } else {
          balance -= bet;
        }
        balanceHistory.push(balance);
        updateChart();
        document.getElementById('balanceDisplay').innerText = `ğŸ’µ Ø§Ù„Ø±ØµÙŠØ¯: ${balance} Ø¯Ø±Ù‡Ù…`;
      }
    }
  </script>
</body>
</html>
