<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>BACCARAT PREDICTOR PRO</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      background-color: #121212;
      color: gold;
      font-family: 'Segoe UI', Tahoma, sans-serif;
      padding: 2em;
      direction: rtl;
      text-align: center;
      transition: all 0.3s ease;
    }
    body.light-mode {
      background-color: #f5f5f5;
      color: #333;
    }
    h1 { font-size: 2.5em; margin-bottom: 20px; }
    
    /* ØªØµÙ…ÙŠÙ… Ø¬Ø¯ÙŠØ¯ Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø±Ù‡Ø§Ù† */
    .bet-amount-container {
      margin: 20px auto;
      padding: 15px;
      background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,215,0,0.05));
      border-radius: 15px;
      max-width: 300px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      border: 1px solid rgba(255,215,0,0.3);
    }
    
    .bet-amount-container label {
      display: block;
      margin-bottom: 8px;
      font-size: 1.1em;
      color: gold;
      font-weight: bold;
    }
    
    .bet-amount-container input {
      padding: 12px 15px;
      font-size: 1.2em;
      width: 80%;
      text-align: center;
      border-radius: 10px;
      border: 2px solid gold;
      background-color: rgba(0,0,0,0.3);
      color: white;
      transition: all 0.3s ease;
    }
    
    .bet-amount-container input:focus {
      outline: none;
      border-color: #ffd700;
      box-shadow: 0 0 10px rgba(255,215,0,0.5);
    }
    
    .buttons {
      margin-top: 20px;
    }
    
    .buttons button {
      padding: 1em 1.8em;
      font-size: 1.1em;
      margin: 0.5em;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: bold;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      min-width: 120px;
    }
    
    .player { 
      background-color: #007bff; 
      color: white; 
      border-bottom: 4px solid #0056b3;
    }
    .player:hover {
      background-color: #0069d9;
      transform: translateY(-2px);
    }
    
    .banker { 
      background-color: #dc3545; 
      color: white;
      border-bottom: 4px solid #a71d2a;
    }
    .banker:hover {
      background-color: #c82333;
      transform: translateY(-2px);
    }
    
    .tie { 
      background-color: #28a745; 
      color: white;
      border-bottom: 4px solid #1e7e34;
    }
    .tie:hover {
      background-color: #218838;
      transform: translateY(-2px);
    }
    
    .reset { 
      background-color: #555; 
      color: gold; 
      margin-top: 1.5em;
      padding: 0.8em 2em;
      border-bottom: 4px solid #333;
    }
    .reset:hover {
      background-color: #444;
      transform: translateY(-2px);
    }
    
    /* Ø¨Ù‚ÙŠØ© Ø§Ù„Ø£Ù†Ù…Ø§Ø·... */
    .language-container {
      position: absolute;
      top: 20px;
      left: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .language, .amount {
      padding: 0.5em;
      font-size: 1em;
      width: 150px;
      border-radius: 8px;
      border: 1px solid rgba(255,215,0,0.3);
      background-color: rgba(0,0,0,0.3);
      color: white;
    }
    .result, .stats, .history, .balance, .ai-stats, .ai-advice, .trends-container {
      margin-top: 1.5em;
      font-size: 1.2em;
      padding: 15px;
      border-radius: 12px;
      background-color: rgba(0,0,0,0.2);
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    body.light-mode .result, 
    body.light-mode .stats, 
    body.light-mode .history, 
    body.light-mode .balance, 
    body.light-mode .ai-stats, 
    body.light-mode .ai-advice,
    body.light-mode .trends-container {
      background-color: rgba(0,0,0,0.05);
    }
    canvas {
      margin-top: 2em;
      max-width: 100%;
      background-color: rgba(0,0,0,0.2);
      border-radius: 12px;
      padding: 10px;
    }
    .theme-toggle {
      background: none;
      border: none;
      font-size: 1.5em;
      cursor: pointer;
      color: gold;
      transition: transform 0.3s ease;
    }
    .theme-toggle:hover {
      transform: rotate(30deg);
    }
    body.light-mode .theme-toggle {
      color: #333;
    }
    .ai-advice {
      border-left: 4px solid gold;
    }
    .player-text { color: #007bff; }
    .banker-text { color: #dc3545; }
    .tie-text { color: #28a745; }
    
    .results-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1em 0;
      text-align: center;
    }
    .results-table th, .results-table td {
      padding: 10px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    body.light-mode .results-table th, 
    body.light-mode .results-table td {
      border-color: rgba(0, 0, 0, 0.1);
    }
    
    .big-road-container {
      margin-top: 2em;
      padding: 1em;
      background-color: rgba(0, 0, 0, 0.3);
      border-radius: 12px;
      direction: ltr;
      overflow-x: auto;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .big-road {
      display: inline-grid;
      grid-auto-flow: column;
      grid-template-rows: repeat(6, 30px);
      gap: 4px;
      padding: 10px;
    }
    .big-road-cell {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .big-road-P { background-color: #007bff; color: white; }
    .big-road-B { background-color: #dc3545; color: white; }
    .big-road-T { background-color: #28a745; color: white; }
    
    .prediction-title {
      color: gold;
      font-size: 1.3em;
      font-weight: bold;
      margin-bottom: 5px;
      text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
    }
    
    .prediction-value {
      font-size: 1.2em;
      font-weight: bold;
      padding: 8px 15px;
      border-radius: 8px;
      display: inline-block;
      margin: 5px 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    .prediction-banker {
      background-color: rgba(220, 53, 69, 0.2);
      color: #dc3545;
      border: 1px solid #dc3545;
    }
    
    .prediction-player {
      background-color: rgba(0, 123, 255, 0.2);
      color: #007bff;
      border: 1px solid #007bff;
    }
    
    .prediction-tie {
      background-color: rgba(40, 167, 69, 0.2);
      color: #28a745;
      border: 1px solid #28a745;
    }
    
    .hot-results-table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
      background-color: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .hot-results-table th {
      background-color: rgba(255, 215, 0, 0.1);
      padding: 10px;
      text-align: center;
      font-weight: bold;
    }
    
    .hot-results-table td {
      padding: 10px;
      text-align: center;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .hot { color: #FF5722; font-weight: bold; }
    .cold { color: #2196F3; font-weight: bold; }
    
    .bets-history-table {
      width: 100%;
      margin: 15px 0;
      border-collapse: collapse;
      background-color: rgba(0, 0, 0, 0.2);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .bets-history-table th, 
    .bets-history-table td {
      padding: 10px 12px;
      text-align: center;
      border: 1px solid rgba(255, 215, 0, 0.2);
    }
    
    .bets-history-table th {
      background-color: rgba(255, 215, 0, 0.1);
      font-weight: bold;
    }
    
    .win { color: #28a745; font-weight: bold; }
    .loss { color: #dc3545; font-weight: bold; }
    
    .performance-summary {
      margin-top: 20px;
      padding: 20px;
      background-color: rgba(0, 0, 0, 0.2);
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .overall-stats {
      display: flex;
      justify-content: space-around;
      flex-wrap: wrap;
      margin-bottom: 15px;
      padding: 15px;
      background-color: rgba(255, 215, 0, 0.05);
      border-radius: 10px;
      gap: 10px;
    }
    
    .overall-stats div {
      padding: 8px 12px;
      border-radius: 8px;
      background-color: rgba(0,0,0,0.2);
      min-width: 120px;
    }
    
    .performance-by-type {
      width: 100%;
      margin-top: 15px;
      border-collapse: collapse;
      background-color: rgba(0,0,0,0.1);
      border-radius: 10px;
    }
    
    .performance-by-type th {
      padding: 12px;
      background-color: rgba(255,215,0,0.1);
    }
    
    .performance-by-type td {
      padding: 10px;
      border-top: 1px solid rgba(255,255,255,0.1);
    }
    
    .bet-odds {
      font-size: 0.9em;
      opacity: 0.8;
      margin-top: 5px;
    }
    
    .balance-display {
      font-size: 1.3em;
      font-weight: bold;
      padding: 12px;
      border-radius: 10px;
      background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,215,0,0.05));
      display: inline-block;
      min-width: 200px;
      margin: 10px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù…Ø¤Ø´Ø±Ø§Øª ÙˆØ§Ù„Ø³Ù„Ø§Ø³Ù„ */
    .trend-indicator {
      font-size: 1.2em;
      margin-left: 5px;
      vertical-align: middle;
    }
    .trend-up {
      color: #28a745;
    }
    .trend-down {
      color: #dc3545;
    }
    .trend-neutral {
      color: #6c757d;
    }
    
    .streak-indicator {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 12px;
      font-weight: bold;
      margin-left: 5px;
      font-size: 0.8em;
    }
    .hot-streak {
      background-color: #FF5722;
      color: white;
    }
    .cold-streak {
      background-color: #2196F3;
      color: white;
    }
    
    .pattern-badge {
      display: inline-block;
      padding: 3px 8px;
      background-color: rgba(255, 215, 0, 0.2);
      border-radius: 10px;
      margin: 2px;
      font-size: 0.85em;
    }
    
    .trend-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      margin: 5px 0;
      border-radius: 8px;
      background-color: rgba(255,255,255,0.05);
    }
    
    .trend-value {
      font-weight: bold;
    }
    
    /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØªÙ†Ø¨Ø¤Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© */
    .prediction-section {
      margin: 20px 0;
      padding: 15px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
    }
    
    .prediction-bars {
      display: flex;
      height: 40px;
      margin: 10px 0;
      border-radius: 5px;
      overflow: hidden;
    }
    
    .prediction-bar {
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      transition: width 0.5s ease;
    }
    
    .player-bar { background-color: #007BFF; }
    .banker-bar { background-color: #DC3545; }
    .tie-bar { background-color: #28A745; }
    
    .probability-display {
      display: flex;
      justify-content: space-between;
      margin-top: 5px;
    }
    
    .probability-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 30%;
    }
    
    .probability-value {
      font-weight: bold;
      font-size: 1.1em;
    }
    
    @media (max-width: 768px) {
      body {
        padding: 1em;
      }
      .buttons button {
        padding: 0.8em;
        min-width: 100px;
        font-size: 1em;
      }
      .overall-stats {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <div class="language-container">
    <select id="langSelect" class="language">
      <option value="ar-MA">ğŸ‡²ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
      <option value="en-US">ğŸ‡ºğŸ‡¸ English</option>
    </select>
    <button class="theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
  </div>

  <h1>BACCARAT PREDICTOR PRO</h1>
  
  <!-- ØªØµÙ…ÙŠÙ… Ø¬Ø¯ÙŠØ¯ Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø±Ù‡Ø§Ù† -->
  <div class="bet-amount-container">
    <label for="betAmount">ğŸ’° Ù…Ø¨Ù„Øº Ø§Ù„Ø±Ù‡Ø§Ù† Ø¨Ø§Ù„Ø¯Ø±Ù‡Ù…</label>
    <input type="number" id="betAmount" class="amount" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" min="1" step="1" />
  </div>
  
  <p>ğŸ“² Ø§Ø®ØªØ± Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¬ÙˆÙ„Ø©:</p>
  <div class="buttons">
    <button class="player" onclick="addResult('P')">
      ğŸ”µ Ø§Ù„Ù„Ø§Ø¹Ø¨
      <div class="bet-odds">1:1</div>
    </button>
    <button class="banker" onclick="addResult('B')">
      ğŸ”´ Ø§Ù„Ù…ØµØ±ÙÙŠ
      <div class="bet-odds">0.95:1</div>
    </button>
    <button class="tie" onclick="addResult('T')">
      ğŸŸ¢ ØªØ¹Ø§Ø¯Ù„
      <div class="bet-odds">8:1</div>
    </button>
  </div>

  <!-- Ù‚Ø³Ù… Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© -->
  <div class="prediction-section" id="predictionResult">
    <div class="prediction-title">ğŸ“Š ØªÙ†Ø¨Ø¤Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</div>
    <div id="predictionBars" class="prediction-bars">
      <div class="prediction-bar player-bar" style="width:33%">P</div>
      <div class="prediction-bar banker-bar" style="width:34%">B</div>
      <div class="prediction-bar tie-bar" style="width:33%">T</div>
    </div>
    <div class="probability-display">
      <div class="probability-item">
        <span class="player-text">Ù„Ø§Ø¹Ø¨</span>
        <span id="playerProb" class="probability-value player-text">33%</span>
      </div>
      <div class="probability-item">
        <span class="banker-text">Ù…ØµØ±ÙÙŠ</span>
        <span id="bankerProb" class="probability-value banker-text">34%</span>
      </div>
      <div class="probability-item">
        <span class="tie-text">ØªØ¹Ø§Ø¯Ù„</span>
        <span id="tieProb" class="probability-value tie-text">33%</span>
      </div>
    </div>
  </div>
  
  <div class="stats" id="statsResult"></div>
  <div class="ai-stats" id="aiStats"></div>
  
  <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯ -->
  <div class="trends-container" id="trendsContainer">
    <h3>ğŸ“ˆ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª ÙˆØ§Ù„Ø£Ù†Ù…Ø§Ø·</h3>
    <div id="trendsContent"></div>
  </div>
  
  <div class="ai-advice" id="aiAdvice"></div>
  <div class="history" id="historyDisplay"></div>
  
  <div class="balance-display" id="balanceDisplay">
    ğŸ’µ Ø§Ù„Ø±ØµÙŠØ¯: <span id="balanceValue">0</span> Ø¯Ø±Ù‡Ù…
  </div>
  
  <div id="betsHistoryContainer" style="display: none;">
    <h3>ğŸ“‹ Ø³Ø¬Ù„ Ø§Ù„Ø±Ù‡Ø§Ù†Ø§Øª</h3>
    <table class="bets-history-table">
      <thead>
        <tr>
          <th>Ø§Ù„Ø¬ÙˆÙ„Ø©</th>
          <th>Ø§Ù„Ø±Ù‡Ø§Ù† Ø¹Ù„Ù‰</th>
          <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
          <th>Ø§Ù„Ù†ØªÙŠØ¬Ø©</th>
          <th>Ø§Ù„Ø±Ø¨Ø­/Ø§Ù„Ø®Ø³Ø§Ø±Ø©</th>
        </tr>
      </thead>
      <tbody id="betsHistoryBody"></tbody>
    </table>
  </div>
  
  <div id="performanceSummary" class="performance-summary" style="display: none;">
    <h3>ğŸ“Š ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ø¯Ø§Ø¡</h3>
    <div class="overall-stats" id="overallStats"></div>
    <table class="performance-by-type">
      <thead>
        <tr>
          <th>Ù†ÙˆØ¹ Ø§Ù„Ø±Ù‡Ø§Ù†</th>
          <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø±Ù‡Ø§Ù†Ø§Øª</th>
          <th>Ø§Ù„ÙÙˆØ²</th>
          <th>Ø§Ù„Ø®Ø³Ø§Ø±Ø©</th>
          <th>Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙÙˆØ²</th>
          <th>ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</th>
        </tr>
      </thead>
      <tbody id="performanceByType"></tbody>
    </table>
  </div>

  <div style="margin-top: 20px;">
    <button class="reset" onclick="resetData()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
    <button class="reset" onclick="toggleBetsHistory()">ğŸ“Š Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø±Ù‡Ø§Ù†Ø§Øª</button>
  </div>

  <canvas id="chart" width="400" height="150"></canvas>

  <div class="big-road-container">
    <h2>Big Road (Ø§Ù„Ù…ÙŠØ¬ÙˆØ±Ùƒ)</h2>
    <div id="bigRoad" class="big-road"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    let history = [];
    let balance = 0;
    let balanceHistory = [0]; // Ø¨Ø¯Ø¡ Ø§Ù„Ø±ØµÙŠØ¯ Ù…Ù† Ø§Ù„ØµÙØ±
    let currentStreak = { type: null, count: 0 };
    let betsHistory = [];
    let showBetsHistory = false;
    let lang = 'ar-MA';

    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
    document.addEventListener('DOMContentLoaded', function() {
      loadTheme();
      loadLanguage();
      initChart();
      document.getElementById('langSelect').addEventListener('change', changeLanguage);
    });

    if (localStorage.getItem('theme') === 'light') {
      document.body.classList.add('light-mode');
    }

    const ctx = document.getElementById('chart').getContext('2d');
    let chart;

    function initChart() {
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: [],
          datasets: [{
            label: 'Ø§Ù„Ø±ØµÙŠØ¯',
            data: [],
            backgroundColor: 'rgba(255, 215, 0, 0.2)',
            borderColor: 'gold',
            borderWidth: 2,
            pointBackgroundColor: 'gold',
            pointRadius: 4,
            fill: true,
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              callbacks: {
                label: function(context) {
                  return 'Ø§Ù„Ø±ØµÙŠØ¯: ' + context.raw.toFixed(2) + ' Ø¯Ø±Ù‡Ù…';
                }
              }
            }
          },
          scales: {
            y: { 
              beginAtZero: true,
              ticks: {
                callback: function(value) {
                  return value + ' Ø¯Ø±Ù‡Ù…';
                }
              }
            }
          }
        }
      });
    }

    function toggleTheme() {
      document.body.classList.toggle('light-mode');
      const isLight = document.body.classList.contains('light-mode');
      localStorage.setItem('theme', isLight ? 'light' : 'dark');
    }

    function loadTheme() {
      if (localStorage.getItem('theme') === 'light') {
        document.body.classList.add('light-mode');
      }
    }

    function changeLanguage() {
      lang = document.getElementById('langSelect').value;
      localStorage.setItem('lang', lang);
      updateUI();
    }

    function loadLanguage() {
      const savedLang = localStorage.getItem('lang') || 'ar-MA';
      document.getElementById('langSelect').value = savedLang;
      lang = savedLang;
    }

    function speak(text, lang) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = lang;
      speechSynthesis.speak(utter);
    }

    function updateChart() {
      chart.data.labels = balanceHistory.map((_, i) => i);
      chart.data.datasets[0].data = balanceHistory;
      chart.update();
    }

    function updateBigRoad() {
      const bigRoadElement = document.getElementById('bigRoad');
      bigRoadElement.innerHTML = '';
      
      let row = 0;
      let col = 0;
      const maxRows = 6;

      const filteredHistory = history.filter(result => result !== 'T');

      for (let i = 0; i < filteredHistory.length; i++) {
        const result = filteredHistory[i];
        
        if (i > 0 && result === filteredHistory[i - 1]) {
          row++;
          if (row >= maxRows) {
            row = 0;
            col++;
          }
        } else {
          row = 0;
          if (i > 0) col++;
        }

        const cell = document.createElement('div');
        cell.className = `big-road-cell big-road-${result}`;
        cell.textContent = result === 'P' ? 'P' : 'B';
        cell.style.gridColumn = col + 1;
        cell.style.gridRow = row + 1;
        bigRoadElement.appendChild(cell);
      }
    }

    function calculateProfit(betOn, outcome, amount) {
      if (!amount || amount <= 0) return 0; // Ù„Ø§ Ø±Ø¨Ø­ ÙˆÙ„Ø§ Ø®Ø³Ø§Ø±Ø© Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø±Ù‡Ø§Ù†
      
      if (betOn === outcome) {
        if (betOn === 'T') return amount * 8; // ØªØ¹Ø§Ø¯Ù„ 8:1
        if (betOn === 'B') return amount * 0.95; // Ù…ØµØ±ÙÙŠ Ù…Ø¹ Ø®ØµÙ… 5%
        return amount * 1; // Ù„Ø§Ø¹Ø¨ 1:1
      }
      return -amount; // Ø®Ø³Ø§Ø±Ø©
    }

    function updateBalance(profit) {
      balance += profit;
      balanceHistory.push(balance);
      document.getElementById('balanceValue').textContent = balance.toFixed(2);
      updateChart();
      
      // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„Ø±ØµÙŠØ¯
      const balanceDisplay = document.getElementById('balanceDisplay');
      balanceDisplay.style.transform = 'scale(1.05)';
      balanceDisplay.style.transition = 'all 0.3s ease';
      
      setTimeout(() => {
        balanceDisplay.style.transform = 'scale(1)';
      }, 300);
    }

    function updateBetsHistory() {
      const tbody = document.getElementById('betsHistoryBody');
      tbody.innerHTML = '';
      
      const isArabic = lang === 'ar-MA';
      
      betsHistory.forEach(bet => {
        const row = document.createElement('tr');
        
        const outcomeText = isArabic ? 
          (bet.outcome === 'P' ? 'Ù„Ø§Ø¹Ø¨' : bet.outcome === 'B' ? 'Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„') :
          (bet.outcome === 'P' ? 'Player' : bet.outcome === 'B' ? 'Banker' : 'Tie');
        
        const betOnText = isArabic ? 
          (bet.betOn === 'P' ? 'Ù„Ø§Ø¹Ø¨' : bet.betOn === 'B' ? 'Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„') :
          (bet.betOn === 'P' ? 'Player' : bet.betOn === 'B' ? 'Banker' : 'Tie');
        
        const profitClass = bet.profit > 0 ? 'win' : bet.profit < 0 ? 'loss' : '';
        const profitSign = bet.profit > 0 ? '+' : '';
        
        row.innerHTML = `
          <td>${bet.round}</td>
          <td>${betOnText}</td>
          <td>${bet.amount > 0 ? bet.amount.toFixed(2) + ' Ø¯Ø±Ù‡Ù…' : '-'}</td>
          <td>${outcomeText}</td>
          <td class="${profitClass}">${bet.amount > 0 ? (profitSign + bet.profit.toFixed(2) + ' Ø¯Ø±Ù‡Ù…') : '-'}</td>
        `;
        tbody.appendChild(row);
      });
    }

    function updatePerformanceSummary() {
      const overallStats = document.getElementById('overallStats');
      const performanceByType = document.getElementById('performanceByType');
      
      const isArabic = lang === 'ar-MA';
      
      // Ø­Ø³Ø§Ø¨ ÙÙ‚Ø· Ø§Ù„Ø±Ù‡Ø§Ù†Ø§Øª Ø§Ù„ØªÙŠ Ù„Ù‡Ø§ Ù…Ø¨Ù„Øº (ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø±Ù‡Ø§Ù†Ø§Øª Ø§Ù„ØµÙØ±ÙŠØ©)
      const activeBets = betsHistory.filter(bet => bet.amount > 0);
      const totalBets = activeBets.length;
      const totalWins = activeBets.filter(b => b.profit > 0).length;
      const totalLosses = activeBets.filter(b => b.profit < 0).length;
      const winRate = totalBets > 0 ? (totalWins / totalBets * 100).toFixed(1) : 0;
      const totalProfit = activeBets.reduce((sum, bet) => sum + bet.profit, 0);
      
      overallStats.innerHTML = `
        <div>
          <strong>${isArabic ? 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ù‡Ø§Ù†Ø§Øª:' : 'Total Bets:'}</strong> ${totalBets}
        </div>
        <div>
          <strong>${isArabic ? 'Ø§Ù„ÙÙˆØ²:' : 'Wins:'}</strong> <span class="win">${totalWins}</span>
        </div>
        <div>
          <strong>${isArabic ? 'Ø§Ù„Ø®Ø³Ø§Ø±Ø©:' : 'Losses:'}</strong> <span class="loss">${totalLosses}</span>
        </div>
        <div>
          <strong>${isArabic ? 'Ù…Ø¹Ø¯Ù„ Ø§Ù„ÙÙˆØ²:' : 'Win Rate:'}</strong> ${winRate}%
        </div>
        <div>
          <strong>${isArabic ? 'ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­:' : 'Net Profit:'}</strong> 
          <span class="${totalProfit >= 0 ? 'win' : 'loss'}">${totalProfit >= 0 ? '+' : ''}${totalProfit.toFixed(2)} Ø¯Ø±Ù‡Ù…</span>
        </div>
      `;
      
      const types = ['P', 'B', 'T'];
      performanceByType.innerHTML = '';
      
      types.forEach(type => {
        const typeBets = activeBets.filter(b => b.betOn === type);
        const typeTotal = typeBets.length;
        const typeWins = typeBets.filter(b => b.profit > 0).length;
        const typeLosses = typeBets.filter(b => b.profit < 0).length;
        const typeWinRate = typeTotal > 0 ? (typeWins / typeTotal * 100).toFixed(1) : 0;
        const typeProfit = typeBets.reduce((sum, bet) => sum + bet.profit, 0);
        
        const typeName = isArabic ? 
          (type === 'P' ? 'Ù„Ø§Ø¹Ø¨' : type === 'B' ? 'Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„') :
          (type === 'P' ? 'Player' : type === 'B' ? 'Banker' : 'Tie');
        
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${typeName}</td>
          <td>${typeTotal}</td>
          <td>${typeWins}</td>
          <td>${typeLosses}</td>
          <td>${typeWinRate}%</td>
          <td class="${typeProfit >= 0 ? 'win' : 'loss'}">${typeProfit >= 0 ? '+' : ''}${typeProfit.toFixed(2)} Ø¯Ø±Ù‡Ù…</td>
        `;
        performanceByType.appendChild(row);
      });
    }

    function toggleBetsHistory() {
      showBetsHistory = !showBetsHistory;
      document.getElementById('betsHistoryContainer').style.display = showBetsHistory ? 'block' : 'none';
      document.getElementById('performanceSummary').style.display = showBetsHistory ? 'block' : 'none';
      
      if (showBetsHistory) {
        updateBetsHistory();
        updatePerformanceSummary();
      }
    }

    function addResult(result) {
      const betAmountInput = document.getElementById('betAmount');
      const betAmount = parseFloat(betAmountInput.value) || 0;
      
      // Ù…Ø³Ø­ Ø­Ù‚Ù„ Ø§Ù„Ø±Ù‡Ø§Ù† Ø¨Ø¹Ø¯ ÙƒÙ„ Ø¬ÙˆÙ„Ø©
      betAmountInput.value = '';
      
      history.push(result);
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      if (result === currentStreak.type) {
        currentStreak.count++;
      } else {
        currentStreak.type = result;
        currentStreak.count = 1;
      }
      
      const round = history.length;
      // ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„Ø±Ù‡Ø§Ù† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ø§Ù„Ø°ÙŠ ØªÙ… Ø§Ù„Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡
      const betOn = event.target.classList.contains('player') ? 'P' : 
                   event.target.classList.contains('banker') ? 'B' : 'T';
      const profit = calculateProfit(betOn, result, betAmount);
      
      betsHistory.push({
        round,
        betOn,
        amount: betAmount,
        outcome: result,
        profit,
        timestamp: new Date()
      });
      
      updateBalance(profit);
      
      if (showBetsHistory) {
        updateBetsHistory();
        updatePerformanceSummary();
      }
      
      updateDisplay();
      updateBigRoad();
      updateTrendsAndStreaks(); // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø§ØªØ¬Ø§Ù‡
      updatePredictions(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ†Ø¨Ø¤Ø§Øª
      generateAdvice();
    }

    function updateDisplay() {
      const displayText = history.map(r => {
        if (r === 'P') return 'ğŸ”µ';
        if (r === 'B') return 'ğŸ”´';
        if (r === 'T') return 'ğŸŸ¢';
      }).join(' ');
      document.getElementById('historyDisplay').innerText = "Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª: " + displayText;

      const totalRounds = history.length;
      const count = { P: 0, B: 0, T: 0 };
      history.forEach(r => { if (count[r] !== undefined) count[r]++; });

      const statsHTML = `
        <table class="results-table">
          <tr>
            <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª</th>
            <th class="player-text">Ù„Ø§Ø¹Ø¨</th>
            <th class="banker-text">Ù…ØµØ±ÙÙŠ</th>
            <th class="tie-text">ØªØ¹Ø§Ø¯Ù„</th>
          </tr>
          <tr>
            <td>${totalRounds}</td>
            <td class="player-text">${count.P} (${((count.P/totalRounds)*100).toFixed(1)}%)</td>
            <td class="banker-text">${count.B} (${((count.B/totalRounds)*100).toFixed(1)}%)</td>
            <td class="tie-text">${count.T} (${((count.T/totalRounds)*100).toFixed(1)}%)</td>
          </tr>
        </table>
      `;
      document.getElementById('aiStats').innerHTML = statsHTML;
    }

    // Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª ÙˆØ§Ù„Ø³Ù„Ø§Ø³Ù„
    function updateTrendsAndStreaks() {
      const isArabic = lang === 'ar-MA';
      
      if (history.length < 3) {
        document.getElementById('trendsContent').innerHTML = isArabic ? 
          `<div style="text-align:center;padding:10px;">â³ Ø§Ù†ØªØ¸Ø± Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¬ÙˆÙ„Ø§Øª Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª...</div>` : 
          `<div style="text-align:center;padding:10px;">â³ Wait for more rounds to analyze trends...</div>`;
        return;
      }

      const lastSeven = history.slice(-7);
      const lastFourteen = history.length >= 14 ? history.slice(-14, -7) : [];
      
      const counts = { P: 0, B: 0, T: 0 };
      const prevCounts = { P: 0, B: 0, T: 0 };
      
      lastSeven.forEach(r => counts[r]++);
      lastFourteen.forEach(r => prevCounts[r]++);
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù†Ø³Ø¨ÙŠØ©
      const getTrend = (current, prev, total) => {
        const change = total > 0 ? ((current - prev) / total * 100) : 0;
        if (change > 15) return { icon: 'â–²â–²', class: 'trend-up', text: isArabic ? 'Ø§Ø±ØªÙØ§Ø¹ ÙƒØ¨ÙŠØ±' : 'Sharp rise' };
        if (change > 5) return { icon: 'â–²', class: 'trend-up', text: isArabic ? 'Ø§Ø±ØªÙØ§Ø¹' : 'Rising' };
        if (change < -15) return { icon: 'â–¼â–¼', class: 'trend-down', text: isArabic ? 'Ø§Ù†Ø®ÙØ§Ø¶ ÙƒØ¨ÙŠØ±' : 'Sharp drop' };
        if (change < -5) return { icon: 'â–¼', class: 'trend-down', text: isArabic ? 'Ø§Ù†Ø®ÙØ§Ø¶' : 'Dropping' };
        return { icon: 'â”', class: 'trend-neutral', text: isArabic ? 'Ù…Ø³ØªÙ‚Ø±' : 'Stable' };
      };
      
      const pTrend = getTrend(counts.P, prevCounts.P, lastSeven.length);
      const bTrend = getTrend(counts.B, prevCounts.B, lastSeven.length);
      const tTrend = getTrend(counts.T, prevCounts.T, lastSeven.length);
      
      // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ù„Ø§Ø³Ù„
      const hotThreshold = 0.7; // 70% Ø£Ùˆ Ø£ÙƒØ«Ø±
      const coldThreshold = 0.2; // 20% Ø£Ùˆ Ø£Ù‚Ù„
      
      const isHot = (type) => counts[type] / lastSeven.length >= hotThreshold;
      const isCold = (type) => counts[type] / lastSeven.length <= coldThreshold;
      
      // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
      const patterns = detectAdvancedPatterns(history.slice(-15));
      
      // Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      const trendsHTML = `
        <div style="margin-bottom: 15px;">
          <h4 style="margin-bottom: 10px;color:gold;">${isArabic ? 'Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø¢Ø®Ø± 7 Ø¬ÙˆÙ„Ø§Øª' : 'Last 7 Rounds Trends'}</h4>
          
          <div class="trend-item ${isHot('P') ? 'hot-streak' : ''} ${isCold('P') ? 'cold-streak' : ''}">
            <div>
              <span class="player-text">${isArabic ? 'Ù„Ø§Ø¹Ø¨' : 'Player'}</span>
              <span class="trend-value">${counts.P}/${lastSeven.length} (${Math.round(counts.P/lastSeven.length*100)}%)</span>
            </div>
            <div>
              <span class="trend-indicator ${pTrend.class}" title="${pTrend.text}">${pTrend.icon}</span>
              ${isHot('P') ? '<span class="streak-indicator hot-streak">HOT</span>' : ''}
              ${isCold('P') ? '<span class="streak-indicator cold-streak">COLD</span>' : ''}
            </div>
          </div>
          
          <div class="trend-item ${isHot('B') ? 'hot-streak' : ''} ${isCold('B') ? 'cold-streak' : ''}">
            <div>
              <span class="banker-text">${isArabic ? 'Ù…ØµØ±ÙÙŠ' : 'Banker'}</span>
              <span class="trend-value">${counts.B}/${lastSeven.length} (${Math.round(counts.B/lastSeven.length*100)}%)</span>
            </div>
            <div>
              <span class="trend-indicator ${bTrend.class}" title="${bTrend.text}">${bTrend.icon}</span>
              ${isHot('B') ? '<span class="streak-indicator hot-streak">HOT</span>' : ''}
              ${isCold('B') ? '<span class="streak-indicator cold-streak">COLD</span>' : ''}
            </div>
          </div>
          
          <div class="trend-item ${isHot('T') ? 'hot-streak' : ''} ${isCold('T') ? 'cold-streak' : ''}">
            <div>
              <span class="tie-text">${isArabic ? 'ØªØ¹Ø§Ø¯Ù„' : 'Tie'}</span>
              <span class="trend-value">${counts.T}/${lastSeven.length} (${Math.round(counts.T/lastSeven.length*100)}%)</span>
            </div>
            <div>
              <span class="trend-indicator ${tTrend.class}" title="${tTrend.text}">${tTrend.icon}</span>
              ${isHot('T') ? '<span class="streak-indicator hot-streak">HOT</span>' : ''}
              ${isCold('T') ? '<span class="streak-indicator cold-streak">COLD</span>' : ''}
            </div>
          </div>
        </div>
        
        ${patterns.length > 0 ? `
        <div class="patterns-container">
          <h4 style="margin-top:0;margin-bottom:10px;color:gold;">${isArabic ? 'Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒØªØ´ÙØ©' : 'Detected Patterns'}</h4>
          ${patterns.map(p => `
            <div class="pattern-badge">
              ${p.pattern}
              <span class="pattern-tooltip">${p.description[lang] || p.description.en}</span>
            </div>
          `).join('')}
        </div>
        ` : ''}
      `;
      
      document.getElementById('trendsContent').innerHTML = trendsHTML;
    }

    // Ø¯Ø§Ù„Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ø£Ù†Ù…Ø§Ø·
    function detectAdvancedPatterns(recentHistory) {
      if (recentHistory.length < 5) return [];
      
      const patterns = [];
      const lastFive = recentHistory.slice(-5).join('');
      const lastTen = recentHistory.slice(-10).join('');
      
      // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
      const commonPatterns = [
        {
          pattern: 'P-B-P-B-P',
          match: 'PBPBP',
          description: {
            ar: 'Ù†Ù…Ø· ØªÙ†Ø§ÙˆØ¨ Ø¨ÙŠÙ† Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆØ§Ù„Ù…ØµØ±ÙÙŠ',
            en: 'Alternating Player-Banker pattern'
          },
          strength: 0.8
        },
        {
          pattern: '5P',
          match: 'PPPPP',
          description: {
            ar: '5 Ù†ØªØ§Ø¦Ø¬ Ù…ØªØªØ§Ù„ÙŠØ© Ù„Ù„Ø§Ø¹Ø¨',
            en: '5 consecutive Player results'
          },
          strength: 0.9
        },
        {
          pattern: '3T+',
          match: /TTT/g,
          description: {
            ar: '3 ØªØ¹Ø§Ø¯Ù„Ø§Øª Ù…ØªØªØ§Ù„ÙŠØ© Ø£Ùˆ Ø£ÙƒØ«Ø±',
            en: '3 or more consecutive Ties'
          },
          strength: 0.7
        },
        {
          pattern: 'P-P-B-B-P',
          match: 'PPBBP',
          description: {
            ar: 'Ù†Ù…Ø· Ù…Ø²Ø¯ÙˆØ¬ (Ù„Ø§Ø¹Ø¨-Ù„Ø§Ø¹Ø¨ Ø«Ù… Ù…ØµØ±ÙÙŠ-Ù…ØµØ±ÙÙŠ)',
            en: 'Double pattern (P-P then B-B)'
          },
          strength: 0.75
        }
      ];
      
      // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ù†Ù…Ø§Ø·
      commonPatterns.forEach(p => {
        if (typeof p.match === 'string' && lastFive === p.match) {
          patterns.push(p);
        } else if (p.match instanceof RegExp && p.match.test(lastTen)) {
          patterns.push(p);
        }
      });
      
      // Ø§ÙƒØªØ´Ø§Ù Ø³Ù„Ø§Ø³Ù„ Ù‚ØµÙŠØ±Ø©
      const lastThree = recentHistory.slice(-3).join('');
      if (lastThree === 'PPP') {
        patterns.push({
          pattern: '3P',
          description: {
            ar: '3 Ù„Ø§Ø¹Ø¨ Ù…ØªØªØ§Ù„ÙŠØ©',
            en: '3 consecutive Player'
          },
          strength: 0.6
        });
      }
      if (lastThree === 'BBB') {
        patterns.push({
          pattern: '3B',
          description: {
            ar: '3 Ù…ØµØ±ÙÙŠ Ù…ØªØªØ§Ù„ÙŠØ©',
            en: '3 consecutive Banker'
          },
          strength: 0.6
        });
      }
      
      return patterns.sort((a, b) => b.strength - a.strength);
    }

    // Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØªÙ†Ø¨Ø¤Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
    function updatePredictions() {
      const prediction = advancedPredict(history);
      displayPrediction(prediction);
    }

    function advancedPredict(history) {
      if (history.length < 3) {
        return {
          P: 33.3,
          B: 33.3,
          T: 33.3
        };
      }

      // ØªØ­Ù„ÙŠÙ„ Ø¢Ø®Ø± 5 Ùˆ 10 Ø¬ÙˆÙ„Ø§Øª
      const lastFive = history.slice(-5);
      const lastTen = history.length >= 10 ? history.slice(-10) : lastFive;
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ±Ø¯Ø¯Ø§Øª
      const freq5 = { P: 0, B: 0, T: 0 };
      const freq10 = { P: 0, B: 0, T: 0 };
      
      lastFive.forEach(r => freq5[r]++);
      lastTen.forEach(r => freq10[r]++);
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
      const percent5 = {
        P: (freq5.P / 5) * 100,
        B: (freq5.B / 5) * 100,
        T: (freq5.T / 5) * 100
      };
      
      const percent10 = {
        P: (freq10.P / lastTen.length) * 100,
        B: (freq10.B / lastTen.length) * 100,
        T: (freq10.T / lastTen.length) * 100
      };
      
      // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…Ø±Ø¬Ø­ (ÙˆØ²Ù† Ø£ÙƒØ¨Ø± Ù„Ù„Ø¬ÙˆÙ„Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©)
      const weightedAvg = {
        P: (percent5.P * 0.6 + percent10.P * 0.4),
        B: (percent5.B * 0.6 + percent10.B * 0.4),
        T: (percent5.T * 0.6 + percent10.T * 0.4)
      };
      
      // Ø¶Ø¨Ø· Ø§Ù„Ù‚ÙŠÙ… Ù„ØªÙƒÙˆÙ† Ù…Ø¬Ù…ÙˆØ¹Ù‡Ø§ 100%
      const total = weightedAvg.P + weightedAvg.B + weightedAvg.T;
      return {
        P: (weightedAvg.P / total * 100),
        B: (weightedAvg.B / total * 100),
        T: (weightedAvg.T / total * 100)
      };
    }

    function displayPrediction(prediction) {
      const isArabic = lang === 'ar-MA';
      
      // ØªØ­Ø¯ÙŠØ« Ø£Ø´Ø±Ø·Ø© Ø§Ù„ØªÙ†Ø¨Ø¤
      document.querySelector('.player-bar').style.width = `${prediction.P}%`;
      document.querySelector('.banker-bar').style.width = `${prediction.B}%`;
      document.querySelector('.tie-bar').style.width = `${prediction.T}%`;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø¦ÙˆÙŠØ©
      document.getElementById('playerProb').textContent = `${prediction.P.toFixed(1)}%`;
      document.getElementById('bankerProb').textContent = `${prediction.B.toFixed(1)}%`;
      document.getElementById('tieProb').textContent = `${prediction.T.toFixed(1)}%`;
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Øµ Ø§Ù„ØªÙ†Ø¨Ø¤ÙŠ
      let winner = 'P';
      if (prediction.B >= prediction.P && prediction.B >= prediction.T) winner = 'B';
      else if (prediction.T > prediction.P && prediction.T > prediction.B) winner = 'T';
      
      const labels = {
        ar: { P: 'Ø§Ù„Ù„Ø§Ø¹Ø¨', B: 'Ø§Ù„Ù…ØµØ±ÙÙŠ', T: 'ØªØ¹Ø§Ø¯Ù„' },
        en: { P: 'Player', B: 'Banker', T: 'Tie' }
      };
      
      const label = isArabic ? labels.ar[winner] : labels.en[winner];
      const predictionClass = winner === 'P' ? 'prediction-player' : winner === 'B' ? 'prediction-banker' : 'prediction-tie';
      
      const statsHTML = `
        <span class="player-text">ğŸ”µ ${isArabic ? 'Ù„Ø§Ø¹Ø¨' : 'Player'}: ${prediction.P.toFixed(1)}%</span> | 
        <span class="banker-text">ğŸ”´ ${isArabic ? 'Ù…ØµØ±ÙÙŠ' : 'Banker'}: ${prediction.B.toFixed(1)}%</span> | 
        <span class="tie-text">ğŸŸ¢ ${isArabic ? 'ØªØ¹Ø§Ø¯Ù„' : 'Tie'}: ${prediction.T.toFixed(1)}%</span>
      `;
      
      document.getElementById('statsResult').innerHTML = statsHTML;
      
      // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„ØªÙ†Ø¨Ø¤ ØµÙˆØªÙŠØ§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†Ø³Ø¨Ø© Ø£Ø¹Ù„Ù‰ Ù…Ù† 60%
      if (prediction[winner] > 60) {
        const speechText = isArabic
          ? `Ø§Ù„ØªÙ†Ø¨Ø¤: ${label} Ø¨Ù†Ø³Ø¨Ø© ${prediction[winner].toFixed(1)} Ø¨Ø§Ù„Ù…Ø¦Ø©`
          : `Prediction: ${label} with ${prediction[winner].toFixed(1)} percent`;
        speak(speechText, lang);
      }
    }

    function generateAdvice() {
      const isArabic = lang === 'ar-MA';
      
      if (history.length < 3) {
        document.getElementById('aiAdvice').innerHTML = isArabic ? 
          "â³ Ø§Ù†ØªØ¸Ø± Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¬ÙˆÙ„Ø§Øª Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ù…Ø§Ø·..." : 
          "â³ Wait for more rounds to analyze patterns...";
        return;
      }

      const lastTen = history.slice(-10);
      const counts = { P: 0, B: 0, T: 0 };
      lastTen.forEach(r => counts[r]++);
      
      const mostFrequent = Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b);
      const freqPercent = (counts[mostFrequent] / lastTen.length * 100).toFixed(1);
      
      let streakText = "";
      if (currentStreak.count > 2) {
        const typeName = isArabic ? 
          (currentStreak.type === 'P' ? 'Ø§Ù„Ù„Ø§Ø¹Ø¨' : currentStreak.type === 'B' ? 'Ø§Ù„Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„') :
          (currentStreak.type === 'P' ? 'Player' : currentStreak.type === 'B' ? 'Banker' : 'Tie');
        
        streakText = isArabic ?
          `ğŸ“ˆ Ø³Ù„Ø³Ù„Ø© ${typeName} Ù…Ø³ØªÙ…Ø±Ø©: ${currentStreak.count} Ø¬ÙˆÙ„Ø§Øª` :
          `ğŸ“ˆ ${typeName} streak: ${currentStreak.count} rounds`;
      }

      const hotResultsHTML = `
        <table class="hot-results-table">
          <tr>
            <th>${isArabic ? 'Ø§Ù„Ù†ØªÙŠØ¬Ø©' : 'Result'}</th>
            <th>${isArabic ? 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§Øª' : 'Count'}</th>
            <th>${isArabic ? 'Ø§Ù„Ù†Ø³Ø¨Ø©' : 'Percentage'}</th>
          </tr>
          <tr>
            <td class="player-text">${isArabic ? 'Ù„Ø§Ø¹Ø¨' : 'Player'}</td>
            <td>${counts.P}</td>
            <td class="player-text">${((counts.P / lastTen.length) * 100).toFixed(1)}%</td>
          </tr>
          <tr>
            <td class="banker-text">${isArabic ? 'Ù…ØµØ±ÙÙŠ' : 'Banker'}</td>
            <td>${counts.B}</td>
            <td class="banker-text">${((counts.B / lastTen.length) * 100).toFixed(1)}%</td>
          </tr>
          <tr>
            <td class="tie-text">${isArabic ? 'ØªØ¹Ø§Ø¯Ù„' : 'Tie'}</td>
            <td>${counts.T}</td>
            <td class="tie-text">${((counts.T / lastTen.length) * 100).toFixed(1)}%</td>
          </tr>
        </table>
      `;

      let recommendation = "";
      if (currentStreak.count >= 3) {
        recommendation = isArabic ?
          `ğŸ’¡ Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ø±Ù‡Ø§Ù† Ø¹Ù„Ù‰ <span class="${currentStreak.type === 'P' ? 'player-text' : currentStreak.type === 'B' ? 'banker-text' : 'tie-text'}">${currentStreak.type === 'P' ? 'Ø§Ù„Ù„Ø§Ø¹Ø¨' : currentStreak.type === 'B' ? 'Ø§Ù„Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„'}</span>` :
          `ğŸ’¡ Keep betting on <span class="${currentStreak.type === 'P' ? 'player-text' : currentStreak.type === 'B' ? 'banker-text' : 'tie-text'}">${currentStreak.type === 'P' ? 'Player' : currentStreak.type === 'B' ? 'Banker' : 'Tie'}</span>`;
      } else if (parseFloat(freqPercent) > 50) {
        const typeName = isArabic ?
          (mostFrequent === 'P' ? 'Ø§Ù„Ù„Ø§Ø¹Ø¨' : mostFrequent === 'B' ? 'Ø§Ù„Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„') :
          (mostFrequent === 'P' ? 'Player' : mostFrequent === 'B' ? 'Banker' : 'Tie');
        
        recommendation = isArabic ?
          `ğŸ’¡ Ø±Ù‡Ø§Ù† Ø¢Ù…Ù† Ø¹Ù„Ù‰ <span class="${mostFrequent === 'P' ? 'player-text' : mostFrequent === 'B' ? 'banker-text' : 'tie-text'}">${typeName}</span> (${freqPercent}%)` :
          `ğŸ’¡ Safe bet on <span class="${mostFrequent === 'P' ? 'player-text' : mostFrequent === 'B' ? 'banker-text' : 'tie-text'}">${typeName}</span> (${freqPercent}%)`;
      } else {
        recommendation = isArabic ?
          "ğŸ’¡ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ù…Ø· ÙˆØ§Ø¶Ø­ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ù…ØªØ­ÙØ¸Ø©" :
          "ğŸ’¡ No clear pattern, use conservative strategy";
      }

      document.getElementById('aiAdvice').innerHTML = `
        ${streakText ? `<div>${streakText}</div>` : ''}
        ${hotResultsHTML}
        <div style="margin-top: 10px;">${recommendation}</div>
      `;
    }

    function updateUI() {
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
      const isArabic = lang === 'ar-MA';
      
      document.title = isArabic ? 'BACCARAT PREDICTOR PRO' : 'BACCARAT PREDICTOR PRO';
      document.querySelector('h1').textContent = isArabic ? 'BACCARAT PREDICTOR PRO' : 'BACCARAT PREDICTOR PRO';
      document.querySelector('.bet-amount-container label').textContent = isArabic ? 'ğŸ’° Ù…Ø¨Ù„Øº Ø§Ù„Ø±Ù‡Ø§Ù† Ø¨Ø§Ù„Ø¯Ø±Ù‡Ù…' : 'ğŸ’° Bet Amount (MAD)';
      document.querySelector('#betAmount').placeholder = isArabic ? 'Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' : 'Enter amount (optional)';
      document.querySelector('p').textContent = isArabic ? 'ğŸ“² Ø§Ø®ØªØ± Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¬ÙˆÙ„Ø©:' : 'ğŸ“² Select round result:';
      document.querySelector('.player').innerHTML = isArabic ? 'ğŸ”µ Ø§Ù„Ù„Ø§Ø¹Ø¨ <div class="bet-odds">1:1</div>' : 'ğŸ”µ Player <div class="bet-odds">1:1</div>';
      document.querySelector('.banker').innerHTML = isArabic ? 'ğŸ”´ Ø§Ù„Ù…ØµØ±ÙÙŠ <div class="bet-odds">0.95:1</div>' : 'ğŸ”´ Banker <div class="bet-odds">0.95:1</div>';
      document.querySelector('.tie').innerHTML = isArabic ? 'ğŸŸ¢ ØªØ¹Ø§Ø¯Ù„ <div class="bet-odds">8:1</div>' : 'ğŸŸ¢ Tie <div class="bet-odds">8:1</div>';
      document.querySelector('.prediction-title').textContent = isArabic ? 'ğŸ“Š ØªÙ†Ø¨Ø¤Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©' : 'ğŸ“Š Advanced Predictions';
      document.querySelectorAll('.probability-item span')[0].textContent = isArabic ? 'Ù„Ø§Ø¹Ø¨' : 'Player';
      document.querySelectorAll('.probability-item span')[2].textContent = isArabic ? 'Ù…ØµØ±ÙÙŠ' : 'Banker';
      document.querySelectorAll('.probability-item span')[4].textContent = isArabic ? 'ØªØ¹Ø§Ø¯Ù„' : 'Tie';
      document.querySelector('#balanceDisplay').innerHTML = isArabic ? 'ğŸ’µ Ø§Ù„Ø±ØµÙŠØ¯: <span id="balanceValue">0</span> Ø¯Ø±Ù‡Ù…' : 'ğŸ’µ Balance: <span id="balanceValue">0</span> MAD';
      document.querySelectorAll('.reset')[0].textContent = isArabic ? 'ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†' : 'ğŸ”„ Reset';
      document.querySelectorAll('.reset')[1].textContent = isArabic ? 'ğŸ“Š Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø±Ù‡Ø§Ù†Ø§Øª' : 'ğŸ“Š Show Bets History';
      document.querySelector('.big-road-container h2').textContent = isArabic ? 'Big Road (Ø§Ù„Ù…ÙŠØ¬ÙˆØ±Ùƒ)' : 'Big Road';
      
      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
      if (history.length > 0) {
        updateDisplay();
        updatePredictions();
        generateAdvice();
        updateTrendsAndStreaks();
      }
      
      if (showBetsHistory) {
        updateBetsHistory();
        updatePerformanceSummary();
      }
    }

    function resetData() {
      const isArabic = lang === 'ar-MA';
      const confirmMsg = isArabic ? 
        "Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ" : 
        "Are you sure you want to reset all data?";
      
      if (confirm(confirmMsg)) {
        history = [];
        balance = 0;
        balanceHistory = [0];
        betsHistory = [];
        currentStreak = { type: null, count: 0 };
        updateChart();
        updateBigRoad();
        document.getElementById('predictionResult').innerHTML = `
          <div class="prediction-title">${isArabic ? 'ğŸ“Š ØªÙ†Ø¨Ø¤Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©' : 'ğŸ“Š Advanced Predictions'}</div>
          <div id="predictionBars" class="prediction-bars">
            <div class="prediction-bar player-bar" style="width:33%">P</div>
            <div class="prediction-bar banker-bar" style="width:34%">B</div>
            <div class="prediction-bar tie-bar" style="width:33%">T</div>
          </div>
          <div class="probability-display">
            <div class="probability-item">
              <span class="player-text">${isArabic ? 'Ù„Ø§Ø¹Ø¨' : 'Player'}</span>
              <span id="playerProb" class="probability-value player-text">33%</span>
            </div>
            <div class="probability-item">
              <span class="banker-text">${isArabic ? 'Ù…ØµØ±ÙÙŠ' : 'Banker'}</span>
              <span id="bankerProb" class="probability-value banker-text">34%</span>
            </div>
            <div class="probability-item">
              <span class="tie-text">${isArabic ? 'ØªØ¹Ø§Ø¯Ù„' : 'Tie'}</span>
              <span id="tieProb" class="probability-value tie-text">33%</span>
            </div>
          </div>
        `;
        document.getElementById('statsResult').innerText = '';
        document.getElementById('aiStats').innerText = '';
        document.getElementById('aiAdvice').innerText = '';
        document.getElementById('historyDisplay').innerText = '';
        document.getElementById('trendsContent').innerHTML = '';
        document.getElementById('balanceValue').textContent = '0';
        document.getElementById('betsHistoryBody').innerHTML = '';
        document.getElementById('performanceByType').innerHTML = '';
        document.getElementById('overallStats').innerHTML = '';
        document.getElementById('betAmount').value = '';
      }
    }
  </script>
</body>
  </html> 
