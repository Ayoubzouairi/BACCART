<!DOCTYPE html>
<html lang="ar">
<head>
  <!-- Ø¨Ù‚ÙŠØ© Ø§Ù„Ù‡ÙŠØ¯ ÙƒÙ…Ø§ Ù‡ÙŠ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± -->
</head>
<body>
  <!-- Ø¨Ù‚ÙŠØ© Ø§Ù„Ù‡ÙŠÙƒÙ„ HTML ÙƒÙ…Ø§ Ù‡Ùˆ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ± -->

  <script>
    // Ø¨Ù‚ÙŠØ© Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙƒÙ…Ø§ Ù‡ÙŠ
    
    function generateAdvice() {
      const lang = document.getElementById('langSelect').value;
      const isArabic = lang === 'ar-MA';
      
      if (history.length < 3) {
        document.getElementById('aiAdvice').innerHTML = isArabic ? 
          "â³ Ø§Ù†ØªØ¸Ø± Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¬ÙˆÙ„Ø§Øª Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ù…Ø§Ø·..." : 
          "â³ Wait for more rounds to analyze patterns...";
        return;
      }

      // ØªØ­Ù„ÙŠÙ„ Ø¢Ø®Ø± 10 Ø¬ÙˆÙ„Ø§Øª
      const lastTen = history.slice(-10);
      const counts = { P: 0, B: 0, T: 0 };
      lastTen.forEach(r => counts[r]++);
      
      // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø£ÙƒØ«Ø± ØªÙƒØ±Ø§Ø±Ù‹Ø§
      const mostFrequent = Object.keys(counts).reduce((a, b) => counts[a] > counts[b] ? a : b);
      const freqPercent = (counts[mostFrequent] / lastTen.length * 100).toFixed(1);
      
      // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
      let streakText = "";
      if (currentStreak.count > 2) {
        const typeName = isArabic ? 
          (currentStreak.type === 'P' ? 'Ø§Ù„Ù„Ø§Ø¹Ø¨' : currentStreak.type === 'B' ? 'Ø§Ù„Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„') :
          (currentStreak.type === 'P' ? 'Player' : currentStreak.type === 'B' ? 'Banker' : 'Tie');
        
        streakText = isArabic ?
          `ğŸ“ˆ Ø³Ù„Ø³Ù„Ø© ${typeName} Ù…Ø³ØªÙ…Ø±Ø©: ${currentStreak.count} Ø¬ÙˆÙ„Ø§Øª` :
          `ğŸ“ˆ ${typeName} streak: ${currentStreak.count} rounds`;
      }

      // ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³Ø§Ø®Ù†Ø©/Ø§Ù„Ø¨Ø§Ø±Ø¯Ø© (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©)
      let hotColdText = "";
      if (history.length >= 6) { // ÙŠØ¨Ø¯Ø£ Ø§Ù„ØªØ­Ù„ÙŠÙ„ ÙÙ‚Ø· Ø¹Ù†Ø¯ 6 Ø¬ÙˆÙ„Ø§Øª Ø£Ùˆ Ø£ÙƒØ«Ø±
        const hotCold = { P: 0, B: 0, T: 0 };
        history.forEach(r => hotCold[r]++);
        
        hotColdText = isArabic ? "ğŸ”¥ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø³Ø§Ø®Ù†Ø© (Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬ÙˆÙ„Ø§Øª): " : "ğŸ”¥ Hot (all rounds): ";
        Object.keys(hotCold).forEach(key => {
          const typeName = isArabic ? 
            (key === 'P' ? 'Ù„Ø§Ø¹Ø¨' : key === 'B' ? 'Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„') :
            (key === 'P' ? 'Player' : key === 'B' ? 'Banker' : 'Tie');
          
          // ØªØ­Ø¯ÙŠØ¯ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø³Ø§Ø®Ù†Ø© (Ø£ÙƒØ«Ø± Ù…Ù† 40% Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹)
          const percentage = (hotCold[key] / history.length * 100);
          hotColdText += `<span class="${percentage > 40 ? 'hot' : 'cold'}">${typeName} ${hotCold[key]} (${percentage.toFixed(1)}%)</span> `;
        });
      }

      // ØªÙ‚Ø¯ÙŠÙ… ØªÙˆØµÙŠØ© Ù…Ø¨Ø³Ø·Ø©
      let recommendation = "";
      if (currentStreak.count >= 3) {
        recommendation = isArabic ?
          `ğŸ’¡ Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„Ø±Ù‡Ø§Ù† Ø¹Ù„Ù‰ ${currentStreak.type === 'P' ? 'Ø§Ù„Ù„Ø§Ø¹Ø¨' : currentStreak.type === 'B' ? 'Ø§Ù„Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„'}` :
          `ğŸ’¡ Keep betting on ${currentStreak.type === 'P' ? 'Player' : currentStreak.type === 'B' ? 'Banker' : 'Tie'}`;
      } else if (parseFloat(freqPercent) > 50) {
        const typeName = isArabic ?
          (mostFrequent === 'P' ? 'Ø§Ù„Ù„Ø§Ø¹Ø¨' : mostFrequent === 'B' ? 'Ø§Ù„Ù…ØµØ±ÙÙŠ' : 'ØªØ¹Ø§Ø¯Ù„') :
          (mostFrequent === 'P' ? 'Player' : mostFrequent === 'B' ? 'Banker' : 'Tie');
        
        recommendation = isArabic ?
          `ğŸ’¡ Ø±Ù‡Ø§Ù† Ø¢Ù…Ù† Ø¹Ù„Ù‰ ${typeName} (${freqPercent}%)` :
          `ğŸ’¡ Safe bet on ${typeName} (${freqPercent}%)`;
      } else {
        recommendation = isArabic ?
          "ğŸ’¡ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù†Ù…Ø· ÙˆØ§Ø¶Ø­ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ© Ù…ØªØ­ÙØ¸Ø©" :
          "ğŸ’¡ No clear pattern, use conservative strategy";
      }

      // Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª
      document.getElementById('aiAdvice').innerHTML = `
        ${streakText ? `<div>${streakText}</div>` : ''}
        ${hotColdText ? `<div>${hotColdText}</div>` : ''}
        <div class="probability">${recommendation}</div>
      `;
    }

    // Ø¨Ù‚ÙŠØ© Ø§Ù„Ø¯ÙˆØ§Ù„ ÙƒÙ…Ø§ Ù‡ÙŠ Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±
  </script>
</body>
</html>
