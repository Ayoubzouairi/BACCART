<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>AYOUB BACCARAT PRO FULL</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
:root{--gold:#d4af37;--gold-2:#b8871d;--bg-dark:#070606;--card:#0f0e10;--muted:#bfb7a6;--player:#2d7ef7;--banker:#e03b3b;--tie:#28a745;}
*{box-sizing:border-box}
body{font-family:Inter,sans-serif;margin:0;background:linear-gradient(180deg,#050404,#0b0b0b);color:#fff;padding:18px}
.app{max-width:1200px;margin:0 auto}
.top{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px}
.logo{font-weight:800;background:linear-gradient(90deg,var(--gold),#fff3b0);color:#000;padding:8px 12px;border-radius:12px;display:inline-block}
.subtitle{font-size:14px;color:var(--muted);margin-top:4px}
.controls{display:flex;gap:8px;align-items:center}
.card{background:linear-gradient(180deg,var(--card),#0b0b0b);border-radius:12px;padding:12px;box-shadow:0 8px 30px rgba(0,0,0,0.6);border:1px solid rgba(212,175,55,0.08)}
.layout{display:flex;gap:12px}
.left{width:360px;display:flex;flex-direction:column;gap:10px}
.right{flex:1;display:flex;flex-direction:column;gap:12px}
.panel{padding:10px}
.row{display:flex;gap:8px;align-items:center;margin-top:8px}
input[type=number], select{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px;border-radius:8px;color:#fff}
.btn{padding:8px 10px;border-radius:8px;border:0;color:#000;cursor:pointer;font-weight:700;font-size:14px}
.btn.gold{background:linear-gradient(90deg,var(--gold),var(--gold-2));box-shadow:0 6px 20px rgba(212,175,55,0.12)}
.btn.player{background:var(--player)}.btn.banker{background:var(--banker)}.btn.tie{background:var(--tie)}
.btn.ghost{background:rgba(255,255,255,0.1);color:#fff}
.small{font-size:13px;color:var(--muted)}
.muted{color:var(--muted);font-size:12px}
.pattern-list{list-style:none;padding:6px;margin:6px 0 0 0;max-height:200px;overflow:auto}
.pattern-list li{padding:8px;border-radius:8px;margin-bottom:6px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);display:flex;justify-content:space-between;align-items:center}
.section-title{font-weight:700;margin-bottom:6px;color:var(--gold)}
.stat-table{width:100%;border-collapse:collapse}
.stat-table th,.stat-table td{border:1px solid rgba(255,255,255,0.05);padding:6px;text-align:center}
.stat-table th{background:rgba(212,175,55,0.1);font-weight:600}
.player{color:var(--player);font-weight:700}
.banker{color:var(--banker);font-weight:700}
.tie{color:var(--tie);font-weight:700}
.pred-head{display:flex;justify-content:space-between;align-items:center}
.final{font-size:22px;font-weight:800;text-align:center;padding:12px;background:linear-gradient(90deg,rgba(212,175,55,0.06),transparent);border-radius:10px}
.log{max-height:280px;overflow:auto;padding:8px;background:var(--card);border-radius:8px;margin-top:10px}
.foot{display:flex;justify-content:space-between;align-items:center;margin-top:14px}
.credits{opacity:0.85}
canvas{border-radius:10px;background:#0f0e10}
.color-legend{display:flex;gap:15px;justify-content:center;margin-bottom:10px;font-size:14px}
.color-legend span{padding:4px 8px;border-radius:6px}
.prediction-cards{display:flex;gap:10px;justify-content:center;margin:10px 0}
.pred-card{padding:10px;border-radius:8px;text-align:center;min-width:80px;background:rgba(255,255,255,0.05)}
.pred-card.active{transform:scale(1.1);border:2px solid var(--gold)}
.win-effect{animation:winPulse 0.5s ease-in-out}
.loss-effect{animation:lossShake 0.5s ease-in-out}
@keyframes winPulse{0%{transform:scale(1)}50%{transform:scale(1.2)}100%{transform:scale(1)}}
@keyframes lossShake{0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)}}
.analysis-result{margin-top:10px;padding:10px;background:rgba(255,255,255,0.03);border-radius:8px;text-align:center}
.log-title{font-weight:600;margin-bottom:8px;color:var(--gold)}
.log-entry{padding:6px 0;border-bottom:1px solid rgba(255,255,255,0.05);font-size:13px}
.log-entry:last-child{border-bottom:none}
</style>
</head>
<body>
<div class="app">
<header class="top card">
  <div class="brand">
    <div class="logo">AYOUB BACCARAT PRO</div>
    <div class="subtitle">Ù…ØªÙ†Ø¨Ø¦ Ø°ÙƒÙŠ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ù‚ÙˆØ© Ø§Ù„Ø£Ù†Ù…Ø§Ø· ğŸ°ğŸŒ™</div>
  </div>
  <div class="controls">
    <button id="btnReset" class="btn gold">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
  </div>
</header>

<main class="card layout">
<aside class="left">
  <div class="panel card">
    <label>Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ (5 - 10)</label>
    <div class="row">
      <input id="windowSize" type="number" min="5" max="10" value="5">
      <button id="applyWindow" class="btn gold">ØªØ·Ø¨ÙŠÙ‚</button>
    </div>
    <div class="muted small">ÙŠØ­Ù„Ù„ Ø¢Ø®Ø± 5-10 Ø¬ÙˆÙ„Ø§Øª Ù„Ù„ØªÙ†Ø¨Ø¤</div>
  </div>

  <div class="panel card">
    <div class="section-title">Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</div>
    <div class="row">
      <button class="btn player" id="btnP">Ù„Ø§Ø¹Ø¨</button>
      <button class="btn banker" id="btnB">Ù…ØµØ±ÙÙŠ</button>
      <button class="btn tie" id="btnT">ØªØ¹Ø§Ø¯Ù„</button>
    </div>
    <div class="row">
      <button class="btn ghost" id="btnUndo" style="flex:1">ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ø¢Ø®Ø± Ø¬ÙˆÙ„Ø©</button>
    </div>
  </div>

  <div class="panel card patterns">
    <div class="section-title">Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒØªØ´ÙØ©</div>
    <ul id="patternList" class="pattern-list">
      <li><span>ØªØªØ§Ø¨Ø¹</span><span>0</span></li>
      <li><span>ØªØ¨Ø§Ø¯Ù„</span><span>0</span></li>
      <li><span>Ø§Ø²Ø¯ÙˆØ§Ø¬</span><span>0</span></li>
    </ul>
  </div>

  <div class="panel card stats">
    <div class="section-title">Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª</div>
    <table class="stat-table">
      <thead>
        <tr><th>Ø§Ù„Ø¬Ù‡Ø©</th><th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th><th>ÙÙˆØ²</th><th>Ø®Ø³Ø§Ø±Ø©</th><th>Ù†Ø³Ø¨Ø© %</th></tr>
      </thead>
      <tbody>
        <tr><td class="player">Ù„Ø§Ø¹Ø¨</td><td id="pTotal">0</td><td id="pWin">0</td><td id="pLoss">0</td><td id="pPct">0%</td></tr>
        <tr><td class="banker">Ù…ØµØ±ÙÙŠ</td><td id="bTotal">0</td><td id="bWin">0</td><td id="bLoss">0</td><td id="bPct">0%</td></tr>
        <tr><td class="tie">ØªØ¹Ø§Ø¯Ù„</td><td id="tTotal">0</td><td id="tWin">0</td><td id="tLoss">0</td><td id="tPct">0%</td></tr>
      </tbody>
    </table>
  </div>
</aside>

<section class="right card prediction">
  <div class="pred-head">
    <div style="font-weight:700;color:var(--gold)">ØªÙˆÙ‚Ø¹ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</div>
    <div class="muted">Ù†Ø³Ø¨Ø© Ø§Ù„Ø«Ù‚Ø© Ù…Ø¹ØªÙ…Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù†Ù…Ø§Ø·</div>
  </div>

  <div class="color-legend">
    <span class="player">ğŸ”µ Ù„Ø§Ø¹Ø¨</span>
    <span class="banker">ğŸ”´ Ù…ØµØ±ÙÙŠ</span>
    <span class="tie">ğŸŸ¢ ØªØ¹Ø§Ø¯Ù„</span>
  </div>
  
  <canvas id="bigRoad" width="500" height="400"></canvas>

  <div class="prediction-cards">
    <div class="pred-card player" id="predP">
      <div style="font-weight:600;margin-bottom:5px;">Ù„Ø§Ø¹Ø¨</div>
      <div id="predPctP" style="font-size:18px;font-weight:700;">0%</div>
    </div>
    <div class="pred-card banker" id="predB">
      <div style="font-weight:600;margin-bottom:5px;">Ù…ØµØ±ÙÙŠ</div>
      <div id="predPctB" style="font-size:18px;font-weight:700;">0%</div>
    </div>
    <div class="pred-card tie" id="predT">
      <div style="font-weight:600;margin-bottom:5px;">ØªØ¹Ø§Ø¯Ù„</div>
      <div id="predPctT" style="font-size:18px;font-weight:700;">0%</div>
    </div>
  </div>

  <div class="analysis-result">
    <div class="muted" style="margin-bottom:8px;">Ø§Ù„ØªÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ:</div>
    <div class="final" id="finalCard">â€”</div>
  </div>

  <div class="log">
    <div class="log-title">ğŸ“ Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</div>
    <div id="logEntries"></div>
  </div>
</section>
</main>

<footer class="foot card">
<div>ØªØµÙ…ÙŠÙ…: Ayoub â€¢ ØªÙŠÙ…Ø© Ø°Ù‡Ø¨ÙŠØ© Ø¯Ø§ÙƒÙ†Ø©</div>
<div class="credits small">Ù†Ø§ÙØ°Ø© 5-10 â€¢ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ§Øª ÙˆØ²Ù† Ø§Ù„Ø£Ù†Ù…Ø§Ø· â€¢ ÙˆØ§Ø¬Ù‡Ø© Ø¹Ø±Ø¨ÙŠØ©</div>
</footer>

<script>
// Logic.js for AYBOUB BACCARAT PRO FULL
const state = {
  rounds: [],
  windowSize: 5,
  count: { P: 0, B: 0, T: 0 },
  win: { P: 0, B: 0, T: 0 },
  loss: { P: 0, B: 0, T: 0 },
  patterns: {
    ØªØªØ§Ø¨Ø¹: 0,
    ØªØ¨Ø§Ø¯Ù„: 0,
    Ø§Ø²Ø¯ÙˆØ§Ø¬: 0,
    Ø«Ù„Ø§Ø«ÙŠ: 0,
    Ù‚ÙØ²Ø©: 0,
    ØªØ¬Ù…Ø¹: 0
  },
  lastPrediction: { P: 0, B: 0, T: 0, final: 'â€”' }
};

const el = id => document.getElementById(id);

function init() {
  el('windowSize').value = state.windowSize;
  el('applyWindow').onclick = () => {
    const v = Number(el('windowSize').value);
    if (v < 5 || v > 10) {
      alert('Ø§Ù„Ù†Ø§ÙØ°Ø© ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 5 Ùˆ 10');
      return;
    }
    state.windowSize = v;
    updateAll();
    addLogEntry('ØªÙ… ØªØºÙŠÙŠØ± Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø¥Ù„Ù‰ ' + v);
  };

  el('btnP').onclick = () => pushRound('P');
  el('btnB').onclick = () => pushRound('B');
  el('btnT').onclick = () => pushRound('T');
  el('btnUndo').onclick = undoRound;
  el('btnReset').onclick = resetAll;

  updateAll();
  addLogEntry('ØªÙ… Ø¨Ø¯Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ - Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¯Ø®Ø§Ù„');
}

function pushRound(r) {
  // Ø­ÙØ¸ Ø§Ù„ØªÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  const currentPrediction = state.lastPrediction;
  
  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
  state.rounds.push(r);
  state.count[r]++;
  updatePatterns();
  
  // Ø­Ø³Ø§Ø¨ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªÙˆÙ‚Ø¹ ØµØ­ÙŠØ­Ø§Ù‹ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆÙ‚Ø¹ Ø§Ù„Ø³Ø§Ø¨Ù‚
  const didWin = (r === currentPrediction.final && currentPrediction.final !== 'â€”');
  
  // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙÙˆØ²/Ø§Ù„Ø®Ø³Ø§Ø±Ø©
  if (didWin) {
    state.win[r]++;
    // Ø®ØµÙ… Ø§Ù„Ø®Ø³Ø§Ø±Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…Ø³Ø¬Ù„Ø© Ø®Ø·Ø£ Ø³Ø§Ø¨Ù‚Ø§Ù‹
    if (state.loss[r] > 0) state.loss[r]--;
  } else if (currentPrediction.final !== 'â€”') {
    // ÙÙ‚Ø· Ø³Ø¬Ù„ Ø®Ø³Ø§Ø±Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ ØªÙˆÙ‚Ø¹ ÙØ¹Ù„ÙŠ
    state.loss[currentPrediction.final]++;
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙˆÙ‚Ø¹ Ø§Ù„Ø¬Ø¯ÙŠØ¯
  state.lastPrediction = predict();
  
  updatePredictionDisplay(state.lastPrediction);
  showResult(r, currentPrediction, didWin);
  updateAll();
}

function undoRound() {
  if (state.rounds.length === 0) return;
  
  const lastRound = state.rounds.pop();
  state.count[lastRound]--;
  
  // Ø¥Ø¹Ø§Ø¯Ø© Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ù†Ù…Ø§Ø·
  updatePatterns();
  
  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªÙˆÙ‚Ø¹
  state.lastPrediction = predict();
  
  addLogEntry('ØªÙ… Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ø¢Ø®Ø± Ø¬ÙˆÙ„Ø© (' + getResultText(lastRound) + ')');
  updateAll();
}

function resetAll() {
  state.rounds = [];
  state.count = { P: 0, B: 0, T: 0 };
  state.win = { P: 0, B: 0, T: 0 };
  state.loss = { P: 0, B: 0, T: 0 };
  state.patterns = { ØªØªØ§Ø¨Ø¹: 0, ØªØ¨Ø§Ø¯Ù„: 0, Ø§Ø²Ø¯ÙˆØ§Ø¬: 0, Ø«Ù„Ø§Ø«ÙŠ: 0, Ù‚ÙØ²Ø©: 0, ØªØ¬Ù…Ø¹: 0 };
  state.lastPrediction = { P: 33.3, B: 33.3, T: 33.3, final: 'â€”' };
  
  addLogEntry('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª');
  updateAll();
}

function updatePatterns() {
  const recent = state.rounds.slice(-state.windowSize);
  if (recent.length < 2) {
    state.patterns = { ØªØªØ§Ø¨Ø¹: 0, ØªØ¨Ø§Ø¯Ù„: 0, Ø§Ø²Ø¯ÙˆØ§Ø¬: 0, Ø«Ù„Ø§Ø«ÙŠ: 0, Ù‚ÙØ²Ø©: 0, ØªØ¬Ù…Ø¹: 0 };
    return;
  }

  // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØªØ§Ø¨Ø¹
  let streak = 1;
  for (let i = recent.length - 1; i > 0; i--) {
    if (recent[i] === recent[i - 1]) streak++;
    else break;
  }
  state.patterns.ØªØªØ§Ø¨Ø¹ = streak;

  // Ø­Ø³Ø§Ø¨ Ø§Ù„ØªØ¨Ø§Ø¯Ù„ (PingPong)
  let pingpong = 0;
  for (let i = 1; i < recent.length; i++) {
    if (recent[i] !== recent[i - 1]) pingpong++;
  }
  state.patterns.ØªØ¨Ø§Ø¯Ù„ = pingpong;

  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§Ø²Ø¯ÙˆØ§Ø¬
  let doubles = 0;
  for (let i = 1; i < recent.length; i++) {
    if (recent[i] === recent[i - 1]) doubles++;
  }
  state.patterns.Ø§Ø²Ø¯ÙˆØ§Ø¬ = doubles;
}

function predict() {
  const n = Math.min(state.windowSize, state.rounds.length);
  const recent = state.rounds.slice(-n);
  
  if (recent.length === 0) {
    return { P: 33.3, B: 33.3, T: 33.3, final: 'â€”' };
  }

  const counts = { P: 0, B: 0, T: 0 };
  recent.forEach(x => counts[x]++);
  
  const total = recent.length;
  const baseFreq = {
    P: (counts.P / total) * 100,
    B: (counts.B / total) * 100,
    T: (counts.T / total) * 100
  };

  // ØªØ·Ø¨ÙŠÙ‚ ÙˆØ²Ù† Ø§Ù„Ø£Ù†Ù…Ø§Ø·
  const weights = calculatePatternWeights();
  baseFreq.P *= weights.P;
  baseFreq.B *= weights.B;
  baseFreq.T *= weights.T;

  // ØªØ·Ø¨ÙŠØ¹ Ø§Ù„Ù†Ø³Ø¨
  const sum = baseFreq.P + baseFreq.B + baseFreq.T;
  const normalized = {
    P: (baseFreq.P / sum) * 100,
    B: (baseFreq.B / sum) * 100,
    T: (baseFreq.T / sum) * 100
  };

  let final = Object.entries(normalized).sort((a, b) => b[1] - a[1])[0][0];
  
  // ÙÙ‚Ø· ØªÙˆÙ‚Ø¹ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†Ø³Ø¨Ø© Ø£Ø¹Ù„Ù‰ Ù…Ù† 35%
  if (normalized[final] < 35) final = 'â€”';

  return {
    P: normalized.P.toFixed(1),
    B: normalized.B.toFixed(1),
    T: normalized.T.toFixed(1),
    final
  };
}

function calculatePatternWeights() {
  const weights = { P: 1, B: 1, T: 1 };
  const lastRound = state.rounds[state.rounds.length - 1];
  
  if (!lastRound) return weights;
  
  // ÙˆØ²Ù† Ø§Ù„ØªØªØ§Ø¨Ø¹ - ØªÙ‚Ù„ÙŠÙ„ Ø§Ø­ØªÙ…Ø§Ù„ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø§Ù„Ø·ÙˆÙŠÙ„
  if (state.patterns.ØªØªØ§Ø¨Ø¹ >= 3) {
    weights[lastRound] *= 0.6;
  }
  
  // ÙˆØ²Ù† Ø§Ù„ØªØ¨Ø§Ø¯Ù„ - Ø²ÙŠØ§Ø¯Ø© Ø§Ø­ØªÙ…Ø§Ù„ ØªØºÙŠÙŠØ± Ø§Ù„Ù†Ù…Ø·
  if (state.patterns.ØªØ¨Ø§Ø¯Ù„ >= 4) {
    const other = lastRound === 'P' ? 'B' : 'P';
    weights[other] *= 1.3;
  }
  
  return weights;
}

function updatePredictionDisplay(pred) {
  el('predPctP').textContent = pred.P + '%';
  el('predPctB').textContent = pred.B + '%';
  el('predPctT').textContent = pred.T + '%';
  
  // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙ†Ø´ÙŠØ· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
  ['predP', 'predB', 'predT'].forEach(id => {
    el(id).classList.remove('active');
  });
  
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø©
  if (pred.final !== 'â€”') {
    el('pred' + pred.final).classList.add('active');
  }
  
  let finalText = 'â€”';
  if (pred.final === 'P') finalText = 'Ù„Ø§Ø¹Ø¨';
  else if (pred.final === 'B') finalText = 'Ù…ØµØ±ÙÙŠ';
  else if (pred.final === 'T') finalText = 'ØªØ¹Ø§Ø¯Ù„';
  
  el('finalCard').textContent = finalText;
}

function showResult(r, pred, didWin) {
  const resultText = getResultText(r);
  const predText = getResultText(pred.final);
  
  let message = '';
  if (pred.final === 'â€”') {
    message = `ğŸ”¸ Ø¬ÙˆÙ„Ø© Ø¬Ø¯ÙŠØ¯Ø©: ${resultText} | Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙˆÙ‚Ø¹ Ø³Ø§Ø¨Ù‚`;
  } else if (didWin) {
    message = `ğŸ‰ ÙÙˆØ²! ${resultText} | Ø§Ù„ØªÙˆÙ‚Ø¹ ÙƒØ§Ù†: ${predText}`;
  } else {
    message = `âŒ Ø®Ø³Ø§Ø±Ø©! ${resultText} | Ø§Ù„ØªÙˆÙ‚Ø¹ ÙƒØ§Ù†: ${predText}`;
  }
  
  addLogEntry(message);
  
  // ØªØ£Ø«ÙŠØ± Ù…Ø±Ø¦ÙŠ
  const finalCard = el('finalCard');
  finalCard.classList.remove('win-effect', 'loss-effect');
  setTimeout(() => {
    if (didWin) {
      finalCard.classList.add('win-effect');
    } else if (pred.final !== 'â€”') {
      finalCard.classList.add('loss-effect');
    }
  }, 10);
}

function getResultText(r) {
  if (r === 'P') return 'Ù„Ø§Ø¹Ø¨';
  if (r === 'B') return 'Ù…ØµØ±ÙÙŠ';
  if (r === 'T') return 'ØªØ¹Ø§Ø¯Ù„';
  return 'â€”';
}

function addLogEntry(msg) {
  const logEntries = el('logEntries');
  const entry = document.createElement('div');
  entry.className = 'log-entry';
  entry.textContent = msg;
  logEntries.appendChild(entry);
  logEntries.scrollTop = logEntries.scrollHeight;
}

function updateAll() {
  renderStats();
  renderBigRoad();
  renderPatterns();
  updatePredictionDisplay(state.lastPrediction);
}

function renderStats() {
  el('pTotal').textContent = state.count.P;
  el('bTotal').textContent = state.count.B;
  el('tTotal').textContent = state.count.T;
  
  el('pWin').textContent = state.win.P;
  el('bWin').textContent = state.win.B;
  el('tWin').textContent = state.win.T;
  
  el('pLoss').textContent = state.loss.P;
  el('bLoss').textContent = state.loss.B;
  el('tLoss').textContent = state.loss.T;
  
  el('pPct').textContent = calculatePercentage(state.win.P, state.loss.P);
  el('bPct').textContent = calculatePercentage(state.win.B, state.loss.B);
  el('tPct').textContent = calculatePercentage(state.win.T, state.loss.T);
}

function calculatePercentage(win, loss) {
  const total = win + loss;
  return total > 0 ? ((win / total) * 100).toFixed(1) + '%' : '0%';
}

function renderBigRoad() {
  const canvas = el('bigRoad');
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  const size = 25;
  let x = 0, y = 0;
  const maxCols = Math.floor(canvas.width / size);
  
  for (let i = 0; i < state.rounds.length; i++) {
    const r = state.rounds[i];
    ctx.fillStyle = r === 'P' ? '#2d7ef7' : r === 'B' ? '#e03b3b' : '#28a745';
    ctx.fillRect(x * size, y * size, size - 2, size - 2);
    
    y++;
    if (y * size >= canvas.height) {
      y = 0;
      x++;
      if (x >= maxCols) break;
    }
  }
}

function renderPatterns() {
  const ul = el('patternList');
  ul.innerHTML = '';
  
  for (const [pattern, value] of Object.entries(state.patterns)) {
    const li = document.createElement('li');
    li.innerHTML = `<span>${pattern}</span><span>${value}</span>`;
    ul.appendChild(li);
  }
}

// Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
window.onload = init;
</script>
</body>
</html>
